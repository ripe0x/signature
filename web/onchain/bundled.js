(()=>{var qt="FoldMono",Pe="data:font/woff2;charset=utf-8;base64,d09GMgABAAAAAAOIAA4AAAAADAQAAAM2AAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGhYbEBwmBmAAPBEQCo9sjiABNgIkAwwLDAAEIAWCfAcgGzkKIK4GbGOy2GicLj5u8RpRKYyZuIy26Oe9GkG0llXPQhAUoVLRQOiIjYYnUuLluRfqlUh8nv35d3DbeacPRpI7wLzuWl2XGTr+R4rdqk48ecPEg8A0wvynUz9VJ0gGYLd1C/5xl7xv3SZnBWzBGr8QtP8P9KU3gF/4v///XtV/LeBjv+MBmzYJYqG96Ce0h6/5XmbHBNnLAlygYMFqXKAK1bYRcgkLxgZhXaf627YE6gFJIBcCteo1AuwbDBChbA4tEHHa8CDi2utCBABSXokNorp4phkhurc/Cdkmqp0bWqrKalIqUp4jaAbAzD4U5MOrPfX1JpR/yDVAQLZF3YE+VCRkaEcRaEc1Bkq5kJLE/gHUNnm3+zdMKK9aMhR+h189BajFT9I/lJ0BIAcwLMQ2l3Yj73wvYnyWbjmo3XbjJ0eY8W5h/BrjMzLJ2VlnUo3PYuKqtuQN3OLm3X+/upK1DTdwjZsDyUyqec6GEF09syI3F92yUZdMJ62DE7XK6uCueMYse9occDNSOJk2TzuvAA1ohsS27Vw8Tqt1nSmHabjbFnGndFO5K3PzpJ4CUz1JBorMmHHLdmQwBHRTnMkKhQ2QvVOwlGW8DcP5FqbrJJvdjsuaDB97D7UPuQfMWVxWiURGZPMptIkVhKEJKCNQDIyTFKlyZLbV+p53gX4egWr7bX73rYYTy+fRt6NAzImHc31/acg9fC0EFH1/obMyd7VtOx4JfU3acYK4OL1wfhzUFbtqf+2dJ+YG3K/voIAkorej7to5G4ZgZG5J17dlDgasZyO9xT2bOM2geuh5N335H/05CBAo+D8a3teHrs9kVYNvlTICfznXj/qG+mEqQY0AQfnnlyCvvGfUD0jWq5FXOCj0rhgQshT513IJVZZQRF6DIzii0KmJkkZPKLNkNZ7LUKHHe3ulrkb3x2Kgo2PDk1VXwRPT09UzttAnIRgd6m8KBWMNkbgGj19b25mmG2vqxkaEs7LdVDE0VVGmSeKcTHfjguaJm3smpWsmdnzBsDSJIzDqMKW8o1bEecw0dHS0TGzyS4Z6n9NTNSaXDzlPw2BeyPLakJQRk0Wx9HurZUEAAA==",bn='"Courier New", Courier, monospace',Xe=`"${qt}", ${bn}`,Ye=.6,de=.08,pe=.06,wn=.03,En=.05;function Cn(t,e,o){let s=t/255,n=e/255,r=o/255;return(.2126*s+.7152*n+.0722*r)*100}var K=[{hex:"#000000",name:"black",luminance:0,temperature:"neutral",r:0,g:0,b:0},{hex:"#0000AA",name:"blue",luminance:10,temperature:"cool",r:0,g:0,b:170},{hex:"#AA0000",name:"red",luminance:20,temperature:"warm",r:170,g:0,b:0},{hex:"#AA00AA",name:"magenta",luminance:25,temperature:"warm",r:170,g:0,b:170},{hex:"#FFFFFF",name:"white",luminance:100,temperature:"neutral",r:255,g:255,b:255},{hex:"#FFFF55",name:"yellow",luminance:93,temperature:"warm",r:255,g:255,b:85},{hex:"#55FFFF",name:"lightCyan",luminance:85,temperature:"cool",r:85,g:255,b:255},{hex:"#55FF55",name:"lightGreen",luminance:77,temperature:"cool",r:85,g:255,b:85},{hex:"#00AA00",name:"green",luminance:30,temperature:"cool",r:0,g:170,b:0},{hex:"#00AAAA",name:"cyan",luminance:40,temperature:"cool",r:0,g:170,b:170},{hex:"#5555FF",name:"lightBlue",luminance:45,temperature:"cool",r:85,g:85,b:255},{hex:"#FF5555",name:"lightRed",luminance:45,temperature:"warm",r:255,g:85,b:85},{hex:"#FF55FF",name:"lightMagenta",luminance:60,temperature:"warm",r:255,g:85,b:255}],Rn=K.filter(t=>t.luminance<30||t.luminance>70),Tn={black:.2,white:.15,blue:.15,red:.15,magenta:.1,yellow:.1,lightCyan:.08,lightGreen:.07},Rt=K,In=K.filter(t=>t.temperature!=="neutral"),Fn=K.filter(t=>t.temperature!=="neutral"),_e=K,Ao={dark:K.filter(t=>t.luminance<30),light:K.filter(t=>t.luminance>70)},Le={warm:K.filter(t=>t.temperature==="warm"),cool:K.filter(t=>t.temperature==="cool"),neutral:K.filter(t=>t.temperature==="neutral")};function On(t,e,o){let s=t.luminance,n=e.luminance,r=[];for(let i=0;i<o;i++){let p=i/(o-1),u=s+(n-s)*p,h=K.filter(g=>g.temperature===t.temperature||g.temperature==="neutral"),b=h[0],y=Math.abs(b.luminance-u);for(let g of h){let m=Math.abs(g.luminance-u);m<y&&(y=m,b=g)}r.push(b)}return r}function De(t,e,o=4.5){let s=t.luminance/100,n=e.luminance/100,r=Math.max(s,n)+.05,i=Math.min(s,n)+.05;return r/i>=o}function Jt(t,e){return e[Math.floor(t()*e.length)]}function Gn(t,e,o){let s=t(),n=0;for(let r of e)if(n+=o[r.name]||0,s<n)return r;return e[e.length-1]}function $t(t,e,o){e/=100,o/=100;let s=e*Math.min(o,1-o),n=r=>{let i=(r+t/30)%12,p=o-s*Math.max(Math.min(i-3,9-i,1),-1);return Math.round(255*p).toString(16).padStart(2,"0")};return`#${n(0)}${n(8)}${n(4)}`}function Dt(t){let e=parseInt(t.slice(1,3),16)/255,o=parseInt(t.slice(3,5),16)/255,s=parseInt(t.slice(5,7),16)/255,n=Math.max(e,o,s),r=Math.min(e,o,s),i,p,u=(n+r)/2;if(n===r)i=p=0;else{let h=n-r;switch(p=u>.5?h/(2-n-r):h/(n+r),n){case e:i=((o-s)/h+(o<s?6:0))/6;break;case o:i=((s-e)/h+2)/6;break;case s:i=((e-o)/h+4)/6;break}}return{h:i*360,s:p*100,l:u*100}}var vn={red:["cyan","lightCyan"],magenta:["green","lightGreen"],blue:["yellow"],lightRed:["cyan","lightCyan"],lightMagenta:["green","lightGreen"],lightBlue:["yellow"],cyan:["red","lightRed"],lightCyan:["red","lightRed"],green:["magenta","lightMagenta"],lightGreen:["magenta","lightMagenta"],yellow:["blue","lightBlue"],black:["white","yellow","lightCyan"],white:["black","blue","magenta"]};function _n(t,e,o){let n=[];switch(e){case"value":{let r=t.luminance<50;n=Rt.filter(i=>r?i.luminance>60:i.luminance<40);break}case"temperature":{if(t.temperature==="neutral")n=Rt.filter(r=>r.temperature!=="neutral"&&Math.abs(r.luminance-t.luminance)>25);else{let r=t.temperature==="warm"?"cool":"warm";n=Rt.filter(i=>i.temperature===r&&Math.abs(i.luminance-t.luminance)>25)}break}case"complement":{let r=vn[t.name]||[];if(n=Rt.filter(i=>r.includes(i.name)),n.length===0){let i=t.luminance<50;n=Rt.filter(p=>i?p.luminance>60:p.luminance<40)}break}case"clash":{n=Rt.filter(r=>r.name!==t.name&&Math.abs(r.luminance-t.luminance)>20&&Math.abs(r.luminance-t.luminance)<50);break}}return n.sort((r,i)=>Math.abs(i.luminance-t.luminance)-Math.abs(r.luminance-t.luminance)),n.length>0?Jt(o,n):t.luminance<50?K.find(r=>r.name==="white"):K.find(r=>r.name==="black")}function Ln(t,e,o){if(o()<.4)return e;let s=In.filter(r=>r.name!==t.name&&r.name!==e.name&&Math.abs(r.luminance-t.luminance)>20);if(s.length===0)return e;let n=s.filter(r=>["yellow","lightCyan","lightMagenta","lightGreen"].includes(r.name));return n.length>0&&o()<.6?Jt(o,n):Jt(o,s)}function Dn(t){let e=Jt(t,Fn),o;return e.luminance>50?o=K.find(s=>s.name==="black"):e.luminance<30?o=t()<.75?K.find(s=>s.name==="black"):K.find(s=>s.name==="white"):o=t()<.6?K.find(s=>s.name==="black"):K.find(s=>s.name==="white"),{bg:o.hex,text:e.hex,accent:e.hex,strategy:`monochrome/${e.name}`,colorCount:2}}function Sn(t){let e=L(t);if(e()<.12)return Dn(e);let o=Gn(e,Rn,Tn),s=e(),n;s<.4?n="value":s<.68?n="temperature":s<.9?n="complement":n="clash";let r=_n(o,n,e),i=Ln(o,r,e),p=i.hex===r.hex?2:3;return Math.abs(o.luminance-r.luminance)<25?{bg:o.luminance<50?"#000000":"#FFFFFF",text:o.luminance<50?"#FFFFFF":"#000000",accent:"#FFFF55",strategy:n,colorCount:p}:{bg:o.hex,text:r.hex,accent:i.hex,strategy:n,colorCount:p}}function Se(t,e,o){let s=[];for(let n=e;n<=o;n++)t%n===0&&s.push(n);return s}function kn(t,e,o,s){let n=1200-o*2-290,r=1697-o*2-145*2,i=Se(n,20,600),p=Se(r,20,600);i.length===0&&i.push(8),p.length===0&&p.push(12);let u=L(s+9999),h=1+de+pe,b=Ye/h,y=[];for(let c of i)for(let w of p){let a=Math.max(c/w,w/c),f=w*b;a<=3&&c>=f&&y.push({w:c,h:w})}if(y.length===0)return{cellW:8,cellH:12};y.sort((c,w)=>c.w*c.h-w.w*w.h);let g=u(),m;if(g<.03){let c=Math.max(1,Math.ceil(y.length*.1)),w=Math.floor(u()*c);m=y[w]}else if(g<.1){let c=Math.floor(y.length*.1),w=Math.floor(y.length*.25),a=c+Math.floor(u()*Math.max(1,w-c));m=y[Math.min(a,y.length-1)]}else if(g<.45){let c=Math.floor(y.length*.25),w=Math.floor(y.length*.75),a=c+Math.floor(u()*(w-c));m=y[Math.min(a,y.length-1)]}else if(g<.95){let c=Math.floor(y.length*.75),w=Math.floor(y.length*.9),a=c+Math.floor(u()*Math.max(1,w-c));m=y[Math.min(a,y.length-1)]}else{let c=Math.floor(y.length*.9),w=c+Math.floor(u()*(y.length-c));m=y[Math.min(w,y.length-1)]}return{cellW:m.w,cellH:m.h}}function Nn(t){let o=L(t+5555)();return o<.35?"normal":o<.4?"binary":o<.65?"inverted":o<.825?"sparse":"dense"}function Me(t){let e=L(t+7777),o=e();if(o<.25){let s=.2+e()*.2;return{min:s,max:s+.1+e()*.2}}else if(o<.5){let s=.6+e()*.2;return{min:s,max:s+.1+e()*.1}}else return o<.75?{min:.1+e()*.2,max:.7+e()*.3}:{min:.3+e()*.2,max:.5+e()*.5}}function Hn(t){let e=L(t+11111);if(!(e()>=.5))return{hasOverlap:!1,amount:"none"};let s=e(),n;return s<.2?n="5%":s<.4?n="25%":s<.6?n="50%":s<.8?n="75%":n="95%",{hasOverlap:!0,amount:n}}function je(t){let e=L(t+2222);return Math.floor(4+e()*66)}function Be(t){let e=L(t+6666),o=e();return o<.16?{type:"horizontal",jitter:3+e()*12}:o<.32?{type:"vertical",jitter:3+e()*12}:o<.44?{type:"diagonal",angle:e()<.5?45:135,jitter:5+e()*15}:o<.56?{type:"radial",focalX:.2+e()*.6,focalY:.2+e()*.6}:o<.68?{type:"grid",jitter:3+e()*10}:o<.8?{type:"clustered",clusterX:.15+e()*.7,clusterY:.15+e()*.7,spread:.2+e()*.4}:{type:"random"}}function ke(t){let e=t.toUpperCase();return _e.find(o=>o.hex===e)||_e[0]}function Wn(t,e,o){let s=L(t+3333),n=ke(e),r=ke(o),i=n.luminance>50,p=(h,b)=>i?b.luminance-h.luminance:h.luminance-b.luminance;if(s()<.5){let h=On(n,r,6);return[h[0].hex,h[Math.floor(h.length*.33)].hex,h[Math.floor(h.length*.66)].hex,h[h.length-1].hex]}else{let h=r.temperature,b=h==="warm"?"cool":"warm",y=Le[h].filter(x=>De(n,x,2)).sort(p),g=Le[b].filter(x=>De(n,x,2)).sort(p),m=[],c=new Set;y.length>0?(m.push(y[0].hex),c.add(y[0].hex)):(m.push(r.hex),c.add(r.hex));let w=y.filter(x=>!c.has(x.hex));if(w.length>0){let x=w[Math.floor(w.length*.4)];m.push(x.hex),c.add(x.hex)}else m.push(r.hex);let a=g.filter(x=>!c.has(x.hex));if(a.length>0){let x=a[Math.floor(a.length*.5)];m.push(x.hex),c.add(x.hex)}else m.push(r.hex);let f=[...y,...g].filter(x=>!c.has(x.hex)).sort(p);return f.length>0?m.push(f[f.length-1].hex):m.push(r.hex),m}}function Pn(t){return L(t+4444)()<.25}function Xn(t){return L(t+9191)()<.008}function Yn(t){let e=L(t+5555),o=.1+e()*.8,s=0,n=e()<.4,r=n?e()*180:null,i=n?.2+e()*.6:0,p=.3+e()*1.4;return{absorbency:o,intersectionThreshold:s,angleAffinity:r,affinityStrength:i,ceilingMultiplier:p}}function jn(t){let e=t.absorbency<.35?"Resistant":t.absorbency<.65?"Standard":"Absorbent",o=t.intersectionThreshold<.15?"Fine":t.intersectionThreshold<.35?"Medium":"Coarse",s=t.angleAffinity!==null?"Grain":"Uniform";return`${e}/${o}/${s}`}function Bn(t,e,o){return t}var ue=[-1/1,-1/2,-1/4,-1/8,-1/16,1/64,1/32,1/16,1/8,1/4,1/2,1,2];function Un(t,e,o,s,n,r=null){let i=L(t+12345);if(r){let{colGapRatio:C=0,rowGapRatio:D=0}=r,q=e*C,H=o*D,_=e+q,F=o+H,S=_>0?Math.max(1,Math.floor((s+q)/_)):1,j=F>0?Math.max(1,Math.floor((n+H)/F)):1,rt=S*e+(S-1)*q,St=j*o+(j-1)*H,Qt=(s-rt)/2,Zt=(n-St)/2;return{cols:S,rows:j,cellWidth:e,cellHeight:o,colGap:q,rowGap:H,strideX:_,strideY:F,gridOffsetX:Math.max(0,Qt),gridOffsetY:Math.max(0,Zt),actualGridWidth:rt,actualGridHeight:St}}let p=i()<.4,u=!1,h=!1;if(p){let C=i();C<.33?u=!0:(C<.66||(u=!0),h=!0)}let b=()=>{let C=ue.slice(4,11);return i()<.25&&C.push(ue[11]),i()<.2&&C.push(...ue.slice(0,4)),C},y=e,g=o,m=1,c=0,w=1/0,a=u?b():[0];for(let C of a){let D=y*C,q=y+D;if(q<=0)continue;let H=Math.max(1,Math.floor((s+D)/q));if(H===1){let _=Math.min(y,s),F=Math.abs(s-_);F<w&&(w=F,m=1,c=0,y=_)}else{let _=H*y+(H-1)*D;if(_<=s){let F=Math.abs(s-_);F<w&&(w=F,m=H,c=D)}}}m===1&&y<s&&(y=s,c=0);let f=1,x=0,A=1/0,T=h?b():[0];for(let C of T){let D=g*C,q=g+D;if(q<=0)continue;let H=Math.max(1,Math.floor((n+D)/q));if(H===1){let _=Math.min(g,n),F=Math.abs(n-_);F<A&&(A=F,f=1,x=0,g=_)}else{let _=H*g+(H-1)*D;if(_<=n){let F=Math.abs(n-_);F<A&&(A=F,f=H,x=D)}}}f===1&&g<n&&(g=n,x=0);let R=m,O=f,I=c,v=x,et=R*y+(R>1?(R-1)*I:0),Y=O*g+(O>1?(O-1)*v:0),l=s-et,N=n-Y;return{cols:R,rows:O,cellWidth:y,cellHeight:g,colGap:I,rowGap:v,strideX:y+I,strideY:g+v,gridOffsetX:l>0?l/2:0,gridOffsetY:N>0?N/2:0,actualGridWidth:et,actualGridHeight:Y}}function $n(t){let e=Object.values(t).filter(p=>p>0);if(e.length===0)return{t1:1,t2:2,t3:3,tExtreme:999};e.sort((p,u)=>p-u);let o=(p,u)=>{let h=Math.floor(p.length*u);return p[Math.min(h,p.length-1)]},s=o(e,.7),n=o(e,.94),r=o(e,.94)+1,i=o(e,.985);return{t1:Math.max(.01,s),t2:Math.max(s+.01,n),t3:Math.max(n+.01,r),tExtreme:Math.max(r+.01,i)}}function Tt(t,e){return t===0?0:t<=e.t1?1:t<=e.t2?2:3}var zn=1103515245n,Kn=12345n,Ne=0x7fffffffn;function L(t){let e=BigInt(Math.abs(t)||1);return()=>(e=e*zn+Kn&Ne,Number(e)/Number(Ne))}var X={add:(t,e)=>({x:t.x+e.x,y:t.y+e.y}),sub:(t,e)=>({x:t.x-e.x,y:t.y-e.y}),scale:(t,e)=>({x:t.x*e,y:t.y*e}),dot:(t,e)=>t.x*e.x+t.y*e.y,len:t=>Math.sqrt(t.x*t.x+t.y*t.y),dist:(t,e)=>X.len(X.sub(t,e)),norm:t=>{let e=X.len(t);return e>1e-4?X.scale(t,1/e):{x:0,y:0}},perp:t=>({x:-t.y,y:t.x}),mid:(t,e)=>({x:(t.x+e.x)/2,y:(t.y+e.y)/2}),lerp:(t,e,o)=>({x:t.x+(e.x-t.x)*o,y:t.y+(e.y-t.y)*o}),copy:t=>({x:t.x,y:t.y}),eq:(t,e)=>X.dist(t,e)<.5};function Ae(t,e,o,s){let n=X.sub(e,t),r=X.sub(s,o),i=n.x*r.y-n.y*r.x;if(Math.abs(i)<1e-4)return null;let p=X.sub(o,t),u=(p.x*r.y-p.y*r.x)/i,h=(p.x*n.y-p.y*n.x)/i;return u>=.001&&u<=.999&&h>=.001&&h<=.999?{point:X.add(t,X.scale(n,u)),t:u,u:h}:null}function He(t,e){let o=t.reduce((n,r)=>n+r,0);if(o<=0)return 0;let s=e()*o;for(let n=0;n<t.length;n++)if(s-=t[n],s<=0)return n;return t.length-1}var Vn=0,qn=1,Jn=2,Qn=3;function ot(t,e,o,s){switch(t){case Vn:return{x:e*o,y:0};case qn:return{x:o,y:e*s};case Jn:return{x:(1-e)*o,y:s};case Qn:return{x:0,y:(1-e)*s};default:return{x:e*o,y:0}}}function ge(t,e,o){switch(t){case 0:return{x:0,y:0};case 1:return{x:e,y:0};case 2:return{x:e,y:o};case 3:return{x:0,y:o};default:return{x:0,y:0}}}function Ue(t,e){return{x:t.p1.x+(t.p2.x-t.p1.x)*e,y:t.p1.y+(t.p2.y-t.p1.y)*e}}function me(t,e){let o=e.x-t.x,s=e.y-t.y,n=Math.atan2(s,o)*180/Math.PI;return n<0&&(n+=180),n>=180&&(n-=180),n}function Zn(t,e,o,s,n,r,i){let u=(()=>{if(!i)return[0,1,2,3];switch(i.type){case"horizontal":return[1,3];case"vertical":return[0,2];case"grid":return t%2===0?[1,3]:[0,2];case"diagonal":return[0,1,2,3];case"radial":case"clustered":case"random":default:return[0,1,2,3]}})();if(i&&i.type==="radial"){let g=i.focalX*s,m=i.focalY*n;if(t<10||e.length===0||r()<.6){let c=[{edge:0,dist:m},{edge:1,dist:s-g},{edge:2,dist:n-m},{edge:3,dist:g}];c.sort((x,A)=>x.dist-A.dist);let w=r(),a=w<.5?c[0].edge:w<.8?c[1].edge:c[Math.floor(r()*4)].edge,f;return a===0||a===2?f=.1+g/s*.8+(r()-.5)*.3:f=.1+m/n*.8+(r()-.5)*.3,f=Math.max(.05,Math.min(.95,f)),{point:ot(a,f,s,n),type:"edge",edge:a,t:f}}}if(i&&i.type==="clustered"){let g=i.clusterX*s,m=i.clusterY*n,c=i.spread;if(t<15||r()<.7){let w=[{edge:0,weight:1+(1-Math.abs(m/n))*2},{edge:1,weight:1+g/s*2},{edge:2,weight:1+m/n*2},{edge:3,weight:1+(1-g/s)*2}],a=w.reduce((T,R)=>T+R.weight,0),f=r()*a,x=0;for(let T of w)if(f-=T.weight,f<=0){x=T.edge;break}let A;return x===0||x===2?A=g/s+(r()-.5)*c:A=m/n+(r()-.5)*c,A=Math.max(.05,Math.min(.95,A)),{point:ot(x,A,s,n),type:"edge",edge:x,t:A}}}let h=Math.max(.2,1-t*.015),b=i&&(i.type==="horizontal"||i.type==="vertical"||i.type==="grid");if(b||r()<h||e.length===0&&o.length===0){let g=b?0:i&&i.type==="diagonal"?.5:.15;if(r()<g){let c=Math.floor(r()*4);return{point:ge(c,s,n),type:"corner",corner:c}}else{let c=u[Math.floor(r()*u.length)],w=i&&i.jitter?i.jitter/100:0,a=.05+r()*.9,f=Math.max(.05,Math.min(.95,a+(r()-.5)*w));return{point:ot(c,f,s,n),type:"edge",edge:c,t:f}}}else if(o.length>0&&r()<.35){let m=o[Math.floor(r()*o.length)];return{point:{x:m.x,y:m.y},type:"intersection",intersectionIndex:o.indexOf(m)}}else if(e.length>0){let m=e[Math.floor(r()*e.length)],c=.1+r()*.8;return{point:Ue(m,c),type:"crease",creaseIndex:e.indexOf(m),t:c}}else{let m=u[Math.floor(r()*u.length)],c=.05+r()*.9;return{point:ot(m,c,s,n),type:"edge",edge:m,t:c}}}function to(t,e,o,s,n,r,i,p,u){let h=Math.min(n,r)*.15,b=a=>a===0||a===2,y=a=>a===1||a===3;if(u&&(u.type==="horizontal"||u.type==="vertical"||u.type==="grid")){let a=u.type==="horizontal"||u.type==="grid"&&e%2===0;if(t.type==="edge"){let f=(t.edge+2)%4,x=y(t.edge);if(a&&x||!a&&!x){let A=u.jitter?u.jitter/100:0,T=t.t!==void 0?t.t:.5,R=Math.max(.05,Math.min(.95,T+(i()-.5)*A));return R=1-R,{point:ot(f,R,n,r),type:"edge",edge:f}}}}if(u&&u.type==="diagonal"){let a=u.angle||(i()<.5?45:135);if(t.type==="corner"){let f=(t.corner+2)%4;return{point:ge(f,n,r),type:"corner"}}else if(t.type==="edge"){let f=u.jitter?(i()-.5)*u.jitter:0,x=(a+f)*Math.PI/180,A=t.point.x,T=t.point.y,R=Math.cos(x),O=Math.sin(x),I=null,v=0,et=[{edge:0,y:0},{edge:2,y:r},{edge:3,x:0},{edge:1,x:n}];for(let Y of et){let l=null;if(Y.y!==void 0){let N=(Y.y-T)/O;if(N>0){let C=A+R*N;C>=0&&C<=n&&(l={x:C,y:Y.y})}}else{let N=(Y.x-A)/R;if(N>0){let C=T+O*N;C>=0&&C<=r&&(l={x:Y.x,y:C})}}if(l){let N=X.dist(t.point,l);N>v&&N>=h&&(v=N,I=l)}}if(I)return{point:I,type:"edge"}}}if(u&&u.type==="radial"){let a=u.focalX*n,f=u.focalY*r,x={x:a,y:f},A=t.point.x-a,T=t.point.y-f,R=Math.sqrt(A*A+T*T);if(R>0){let O=A/R,I=T/R,v=1/0;O>0&&(v=Math.min(v,(n-t.point.x)/O)),O<0&&(v=Math.min(v,-t.point.x/O)),I>0&&(v=Math.min(v,(r-t.point.y)/I)),I<0&&(v=Math.min(v,-t.point.y/I));let et={x:Math.max(0,Math.min(n,t.point.x+O*v*.95)),y:Math.max(0,Math.min(r,t.point.y+I*v*.95))};if(X.dist(t.point,et)>=h)return{point:et,type:"edge"}}}if(u&&u.type==="clustered"){let a=u.clusterX*n,f=u.clusterY*r,x={x:a,y:f},A=[];for(let R=0;R<4;R++)for(let O=0;O<3;O++){let I=.1+i()*.8,v=ot(R,I,n,r),et=eo(x,t.point,v),Y=Math.max(n,r)*.5,l=Math.max(.1,1-et/Y)*3;A.push({point:v,type:"edge",edge:R,weight:l})}let T=A.filter(R=>X.dist(t.point,R.point)>=h);if(T.length>0){let R=T.map(I=>I.weight),O=He(R,i);return T[O]}}let g=[];if(t.type==="edge"){let a=(t.edge+2)%4,f=(t.edge+1)%4,x=(t.edge+3)%4,A=e<3?3:1.5;for(let R=0;R<3;R++){let O=.1+i()*.8;g.push({point:ot(a,O,n,r),type:"edge",edge:a,weight:A})}let T=1;for(let R=0;R<2;R++){let O=.1+i()*.8;g.push({point:ot(f,O,n,r),type:"edge",edge:f,weight:T}),g.push({point:ot(x,O,n,r),type:"edge",edge:x,weight:T})}}else if(t.type==="corner"){let a=(t.corner+2)%4;g.push({point:ge(a,n,r),type:"corner",weight:2});for(let f=0;f<4;f++)if(!(f===t.corner||f===(t.corner+3)%4)){let A=.2+i()*.6;g.push({point:ot(f,A,n,r),type:"edge",edge:f,weight:1.5})}}else{for(let a=0;a<4;a++){let f=.1+i()*.8;g.push({point:ot(a,f,n,r),type:"edge",edge:a,weight:1})}if(o.length>1&&e>3)for(let a=0;a<Math.min(3,o.length);a++){let f=Math.floor(i()*o.length),x=o[f];if(t.type==="crease"&&t.creaseIndex===f)continue;let A=.15+i()*.7;g.push({point:Ue(x,A),type:"crease",creaseIndex:f,weight:.6})}}if(o.length>0&&p)for(let a of g){let f=me(t.point,a.point);for(let x of o){let A=me(x.p1,x.p2),T=Math.abs(f-A);T>90&&(T=180-T),p.parallel>0&&T<15&&(a.weight*=1+p.parallel),p.perpendicular>0&&T>75&&(a.weight*=1+p.perpendicular)}}let m=g.filter(a=>X.dist(t.point,a.point)>=h);if(m.length===0){for(let f=0;f<4;f++){let A=ot(f,.5,n,r);if(X.dist(t.point,A)>=h)return{point:A,type:"edge",edge:f}}let a=t.type==="edge"?(t.edge+2)%4:0;return{point:ot(a,.5,n,r),type:"edge",edge:a}}let c=m.map(a=>a.weight),w=He(c,i);return m[w]}function eo(t,e,o){let s=o.x-e.x,n=o.y-e.y,r=s*s+n*n;if(r===0)return X.dist(t,e);let i=((t.x-e.x)*s+(t.y-e.y)*n)/r;i=Math.max(0,Math.min(1,i));let p={x:e.x+i*s,y:e.y+i*n};return X.dist(t,p)}function no(t){let e=[];for(let o=0;o<t.length;o++)for(let s=o+1;s<t.length;s++){let n=Ae(t[o].p1,t[o].p2,t[s].p1,t[s].p2);n&&e.push({x:n.point.x,y:n.point.y,crease1:o,crease2:s})}return e}function $e(t,e,o,s,n={min:0,max:1},r=null,i=null){if(!t||!e||t<=0||e<=0)return{creases:[],finalShape:[]};let p=r||Be(s),u=je(s),h=[{x:0,y:0},{x:t,y:0},{x:t,y:e},{x:0,y:e}],b=[],y=null,g=null;if(!o||o<=0)return{creases:[],finalShape:h,maxFolds:u,firstFoldTarget:null,lastFoldTarget:null};let m=L(s),c=L(s+8888),w=L(s+6666),a=i||{absorbency:1,intersectionThreshold:0,angleAffinity:null,affinityStrength:0,ceilingMultiplier:1},f=[],x=L(s+1111);for(let I=0;I<u;I++)f[I]=.001+x()*.25;let A=L(s+2222),T={parallel:A()*.8,perpendicular:A()*.8},R=Math.max(t,e)*.05,O=[];for(let I=0;I<o;I++){let v=I%u,et=Math.floor(I/u);if(v===0&&et>0)for(let S of b)S.reductionMultiplier!==void 0&&(S.weight=Math.max(.01,S.weight*S.reductionMultiplier));I%5===0&&b.length>1&&(O=no(b));let Y=Zn(I,b,O,t,e,m,p),l=to(Y,I,b,O,t,e,m,T,p),N=Y.point,C=l.point,q=w()<a.absorbency,H=n.min+c()*(n.max-n.min);if(a.angleAffinity!==null&&a.affinityStrength>0){let S=me(N,C),j=Math.abs(S-a.angleAffinity);j>90&&(j=180-j);let rt=1-j/90*a.affinityStrength;H*=rt}if(q&&H>.01&&(b.push({p1:X.copy(N),p2:X.copy(C),depth:b.length,weight:H,cyclePosition:v,reductionMultiplier:f[v],anchorType:Y.type,terminusType:l.type}),b.length>1)){let S=b[b.length-1];for(let j=0;j<b.length-1;j++){let rt=Ae(S.p1,S.p2,b[j].p1,b[j].p2);rt&&O.push({x:rt.point.x,y:rt.point.y,crease1:j,crease2:b.length-1})}}let _=X.mid(N,C),F={x:Math.max(R,Math.min(t-R,_.x)),y:Math.max(R,Math.min(e-R,_.y))};I===0&&y===null&&(y=F),g=F}return{creases:b,finalShape:h,maxFolds:u,firstFoldTarget:y,lastFoldTarget:g}}function oo(t){let e=[];for(let o=0;o<t.length;o++)for(let s=o+1;s<t.length;s++){let n=Ae(t[o].p1,t[o].p2,t[s].p1,t[s].p2);if(n){let r=t[o].weight||1,i=t[s].weight||1;e.push({x:n.point.x,y:n.point.y,depth1:t[o].depth,depth2:t[s].depth,gap:Math.abs(t[s].depth-t[o].depth),weight:r+i})}}return e}function ro(t,e,o,s,n,r=null,i=null){let p=oo(t),u=i||{intersectionThreshold:0,ceilingMultiplier:1},h=p.filter(a=>a.weight>=u.intersectionThreshold),b={},y={},g={};for(let a of h){let f=Math.floor(a.x/s),x=Math.floor(a.y/n);if(f>=0&&f<e&&x>=0&&x<o){let A=`${f},${x}`;b[A]=(b[A]||0)+a.weight,y[A]=Math.max(y[A]||0,a.gap),g[A]=(g[A]||0)+1}}let c=e*o*.5*u.ceilingMultiplier,w=Object.values(b).reduce((a,f)=>a+f,0);if(w>c&&w>0){let a=c/w,f=a+(1-a)*.3;for(let x of Object.keys(b))b[x]*=f}return{activeCreases:t,intersections:h,cellWeights:b,cellMaxGap:y,cellIntersectionCounts:g,destroyed:0,maxFolds:r}}function ze({folds:t,seed:e,outputWidth:o,outputHeight:s,bgColor:n,textColor:r,accentColor:i,cellWidth:p,cellHeight:u,renderMode:h,multiColor:b,levelColors:y,foldStrategy:g=null,paperProperties:m=null,padding:c=0,showCreases:w=!1,showPaperShape:a=!1,showFoldTargets:f=!1,showIntersections:x=!1,showGrid:A=!1,showHitCounts:T=!1,showCellOutlines:R=!1,showCreaseLines:O=!1,fontFamily:I=Xe,linesOnlyMode:v=!1,gapOverrides:et=null}){let Y=document.createElement("canvas"),l=Y.getContext("2d"),N=2;Y.width=o*N,Y.height=s*N,l.setTransform(N,0,0,N,0,0),l.fillStyle=n,l.fillRect(0,0,o,s);let C=o/1200,D=s/1697,q=1200-c*2-145*2,H=1697-c*2-145*2,_=Un(e,p,u,q,H,et),{cols:F,rows:S,strideX:j,strideY:rt,gridOffsetX:St,gridOffsetY:Qt}=_,Zt=_.cellWidth,Ke=_.cellHeight,we=q*C,te=H*D,B=(c+145+St)*C,U=(c+145+Qt)*D,It=Zt*C,kt=Ke*D,Ft=j*C,Ot=rt*D,Ve=Me(e),qe=Bn(m,F,S),Je=_.actualGridWidth,Qe=_.actualGridHeight,{creases:Ee,finalShape:Ze,maxFolds:tn,firstFoldTarget:xt,lastFoldTarget:yt}=$e(Je,Qe,t,e,Ve,g,qe),en=Ee.map(d=>({...d,p1:{x:d.p1.x*C,y:d.p1.y*D},p2:{x:d.p2.x*C,y:d.p2.y*D}})),ee=null;if(xt){let d=Math.max(0,Math.min(F-1,Math.floor(xt.x/j))),M=Math.max(0,Math.min(S-1,Math.floor(xt.y/rt)));ee=`${d},${M}`}let ne=null;if(yt){let d=Math.max(0,Math.min(F-1,Math.floor(yt.x/j))),M=Math.max(0,Math.min(S-1,Math.floor(yt.y/rt)));ne=`${d},${M}`}let{activeCreases:Gt,intersections:Mt,cellWeights:oe,cellMaxGap:re}=ro(en,F,S,Ft,Ot,tn,m),dt=new Set;if(Object.keys(re).length>0){let d=Math.max(...Object.values(re));for(let[M,E]of Object.entries(re))E===d&&dt.add(M)}let nn=1+de+pe,ct=kt/nn,uo=ct>350?"large":ct>100?"medium":"small";l.font=`${ct}px ${I}`,l.textBaseline="top";let lt=[" ","\u2591","\u2592","\u2593"],vt=ct<30?2:3,V=ct*Ye,on=ct*de,Ce=ct*pe,Re=ct*wn,Te=ct*En,ho={" ":{width:V},"\u2591":{width:V,leftOffset:Te,bottomOverflow:Re},"\u2592":{width:V,bottomOverflow:Re},"\u2593":{width:V,bottomOverflow:Ce}},At=$n(oe),Nt=L(e+22222)(),bt;Nt<.6?bt=0:Nt<.8?bt=1:Nt<.9?bt=2:Nt<.97?bt=3:bt=5;let Ht=L(e+33333),wt=Ht(),J;wt<.22?J="ltr":wt<.44?J="rtl":wt<.65?J="center":wt<.8?J="alternate":wt<.9?J="diagonal":wt<.96?J="randomMid":J="checkerboard";let rn=Ht()<.5,sn=Math.floor(Ht()*F),ln=Ht()<.5,Wt=L(e+11111),se=Wt()>=.5,an=(()=>{if(!se)return 1;let d=Wt();return d<.2?.95:d<.4?.75:d<.6?.5:d<.8?.25:.05})(),cn=se?Math.floor(Wt()*5):0,Et=[.95,.75,.5,.25,.05],Ie=Et.indexOf(an),Pt=Math.floor(Wt()*3)+1,fn=(d,M)=>{if(!se)return 1;let E=Ie===-1?0:Ie;switch(cn){case 1:E=(E+Math.floor(d/2)*Pt)%Et.length;break;case 2:E=(E+Math.floor(M/2)*Pt)%Et.length;break;case 3:E=(E+(d+M)%2*Pt)%Et.length;break;case 4:E=(E+Math.floor((d+M)/2)*Pt)%Et.length;break;default:break}return Et[E]},ut=(d,M)=>b&&y?y[Math.min(d,3)]:r,Xt=L(e+22222),ie=Xt()<.1,un=Math.round(2+Xt()*2)*C,hn=Math.round(1+Xt()*2)*D,dn=ie?.4+Xt()*.3:0,pn=(d,M)=>{let E=L(e+22222+d*1e3+M),st=Math.floor(E()*3);return{x:st!==1?un:0,y:st!==0?hn:0}},gn=ie?(()=>{let d=Dt(r),M;return i&&i!==r?M=Dt(i):M={h:(d.h+180)%360,s:Math.min(100,d.s+20),l:d.l},M.l<=d.l&&(M.l=Math.min(95,d.l+25)),$t(M.h,M.s,M.l)})():null,Fe=(c+145)*C,le=(c+145)*D,ae=Fe+Te,mn=le+on,ce=Fe+we,xo=le+te-Ce;if(v){let d=$=>{let G=parseInt($.slice(1,3),16),W=parseInt($.slice(3,5),16),Z=parseInt($.slice(5,7),16);return Cn(G,W,Z)},M=d(n),E=d(r),st=d(i),Q=Math.abs(M-E)>Math.abs(M-st)?r:i;if(Gt.length>0){l.strokeStyle=Q,l.lineWidth=2*C,l.globalAlpha=.9,l.lineCap="round";for(let $ of Gt)l.beginPath(),l.moveTo(B+$.p1.x,U+$.p1.y),l.lineTo(B+$.p2.x,U+$.p2.y),l.stroke()}if(Mt&&Mt.length>0){l.strokeStyle=Q,l.lineWidth=1.5*C,l.globalAlpha=1;let $=4*C;for(let G of Mt)l.beginPath(),l.arc(B+G.x,U+G.y,$,0,Math.PI*2),l.stroke()}l.globalAlpha=1}else if(T){let d=Math.floor(Math.min(It*.45,kt*.7));l.font=`bold ${d}px monospace`,l.textAlign="center",l.textBaseline="middle",l.fillStyle=r;for(let M=0;M<S;M++)for(let E=0;E<F;E++){let st=Math.round(B+E*Ft+It/2),Q=Math.round(U+M*Ot+kt/2),$=`${E},${M}`,G=oe[$]||0;G>0&&l.fillText(Math.round(G).toString(),st,Q)}l.textAlign="left",l.textBaseline="top"}else{let d=Math.max(B,ae),M=Math.max(U,mn);for(let E=0;E<S;E++){let st=Math.round(M+E*Ot);if(!(st>le+te))for(let Q=0;Q<F;Q++){let $=Math.round(d+Q*Ft),G=`${Q},${E}`,W=oe[G]||0,Z=null,z=r,k=-1,Yt=!1;if(ee===G)k=W>0?Tt(W,At):2,Z=lt[Math.min(Math.max(k,2),vt)],z=i;else if(h==="normal")if(k=Tt(W,At),Z=lt[Math.min(k,vt)],k===0&&(Z=lt[1],Yt=!0),z=ut(k,G),W>=1.5){let Ct=W-1.5,pt=30+Math.min(Ct*300,150),tt=Dt(r);z=$t((tt.h+pt+360)%360,Math.min(100,tt.s+20),Math.min(85,tt.l+10))}else dt.has(G)&&W>0?z=i:ne===G&&(z=r);else if(h==="binary")W===0?(Z=lt[0],k=0,z=ut(0,G)):(k=vt,Z=lt[k],z=ut(k,G),dt.has(G)&&(z=i));else if(h==="inverted")if(k=Math.min(3-Tt(W,At),vt),Z=lt[k],z=ut(k,G),W>=1.5){let Ct=W-1.5,pt=30+Math.min(Ct*300,150),tt=Dt(r);z=$t((tt.h+pt+360)%360,Math.min(100,tt.s+20),Math.min(85,tt.l+10))}else dt.has(G)&&W>0&&(z=i);else if(h==="sparse")k=Tt(W,At),k===1&&(Z=lt[1],z=ut(1,G),dt.has(G)&&(z=i));else if(h==="dense")if(k=Tt(W,At),k>=2)if(Z=lt[Math.min(k,vt)],z=ut(k,G),W>=1.5){let Ct=W-1.5,pt=30+Math.min(Ct*300,150),tt=Dt(r);z=$t((tt.h+pt+360)%360,Math.min(100,tt.s+20),Math.min(85,tt.l+10))}else dt.has(G)&&(z=i);else W===0&&(Z=lt[0],k=0,z=ut(0,G));if(Z){if(ee===G||ne===G)l.fillStyle=z;else{let P=ut(Tt(W,At),G);l.fillStyle=dt.has(G)&&W>0?i:P}Yt&&(l.globalAlpha=.1,l.fillStyle=r);let Ct=l.measureText(Z).width,pt=$+It,tt=Math.min(pt,ce),_t=tt-$;if(_t<V*.5)continue;let yn=fn(E,Q),Oe=V*yn,fe=Math.max(1,Math.floor((_t-V)/Oe)+1),Mn=(fe-1)*Oe+V,ft=(_t-Mn)/V>.3?fe+1:fe,gt=ft<=1?V:(_t-V)/(ft-1),Ge=bt*It,ve=0;Ge>0&&(ve=Math.ceil(Ge/gt));let An=ft+ve,at;if(J==="ltr")at="ltr";else if(J==="rtl")at="rtl";else if(J==="center")at="center";else if(J==="alternate")at=E%2===1!==rn?"rtl":"ltr";else if(J==="diagonal"){let P=(sn+(ln?E:-E)+F*100)%F;at=Q<P?"ltr":"rtl"}else if(J==="randomMid"){let P=L(e+55555+E),Lt=Math.floor(P()*F);at=Q<Lt?"ltr":"rtl"}else J==="checkerboard"?at=(E+Q)%2===0?"ltr":"rtl":at="ltr";let jt=$+_t/2;for(let P=0;P<An&&k>=0;P++){let Lt=Z;k>=2&&P>0&&P%2===0&&(Lt=lt[Math.max(0,k-1)]);let nt;if(at==="center")if(P<ft){let it=Math.floor((P+1)/2)*gt;P%2===0?nt=jt+(P===0?-V/2:it-V/2):nt=jt-it-V/2}else{let it=P-ft,Bt=Math.floor(ft/2)*gt,Ut=Math.floor((it+1)/2)*gt;if(it%2===0){if(nt=jt+Bt+Ut,nt+V>ce)break}else if(nt=jt-Bt-Ut-V,nt<ae)break}else if(P<ft)nt=$+P*gt;else if(at==="rtl"){let it=P-ft;if(nt=$-(it+1)*gt,nt<ae)break}else{let it=P-ft;if(nt=tt+it*gt,nt+V>ce)break}if(ie&&!Yt){let it=pn(E,Q),Bt=l.globalAlpha,Ut=l.fillStyle;l.globalAlpha=dn,l.fillStyle=gn,l.fillText(Lt,nt+it.x,st+it.y),l.globalAlpha=Bt,l.fillStyle=Ut}l.fillText(Lt,nt,st)}Yt&&(l.globalAlpha=1)}}}}if(R){l.strokeStyle=i,l.lineWidth=.5,l.globalAlpha=1;for(let d=0;d<S;d++)for(let M=0;M<F;M++){let E=Math.round(B+M*Ft),st=Math.round(U+d*Ot);l.strokeRect(E,st,It,kt)}}if(O&&Gt.length>0){let M=L(e+9292)()<.6;l.strokeStyle=M?i:r,l.lineWidth=1.5*C,l.globalAlpha=.85,l.lineCap="round";for(let E of Gt)l.beginPath(),l.moveTo(B+E.p1.x,U+E.p1.y),l.lineTo(B+E.p2.x,U+E.p2.y),l.stroke();l.globalAlpha=1}if(w){l.strokeStyle="#ff00ff",l.lineWidth=1,l.globalAlpha=.7;for(let d of Gt)l.beginPath(),l.moveTo(B+d.p1.x,U+d.p1.y),l.lineTo(B+d.p2.x,U+d.p2.y),l.stroke();l.globalAlpha=1}if(a){let d=Ze.map(M=>({x:M.x*C,y:M.y*D}));if(d.length>=3){l.strokeStyle="#00ffff",l.lineWidth=2,l.globalAlpha=.9,l.beginPath(),l.moveTo(B+d[0].x,U+d[0].y);for(let M=1;M<d.length;M++)l.lineTo(B+d[M].x,U+d[M].y);l.closePath(),l.stroke(),l.fillStyle="#00ffff",l.globalAlpha=.15,l.fill(),l.globalAlpha=1}}if(A){l.strokeStyle=r,l.lineWidth=1,l.globalAlpha=.3;for(let d=0;d<=F;d++){let M=B+d*Ft;l.beginPath(),l.moveTo(M,U),l.lineTo(M,U+te),l.stroke()}for(let d=0;d<=S;d++){let M=U+d*Ot;l.beginPath(),l.moveTo(B,M),l.lineTo(B+we,M),l.stroke()}l.globalAlpha=1}if(f){let d=8*C;if(l.lineWidth=2,l.globalAlpha=1,xt){let M=B+xt.x*C,E=U+xt.y*D;l.strokeStyle="#00ff00",l.beginPath(),l.arc(M,E,d,0,Math.PI*2),l.stroke()}if(yt){let M=B+yt.x*C,E=U+yt.y*D;l.strokeStyle="#00ff00",l.beginPath(),l.arc(M,E,d,0,Math.PI*2),l.stroke()}}if(x&&Mt&&Mt.length>0){l.strokeStyle="#ff00ff",l.lineWidth=1.5,l.globalAlpha=.7;let d=3;for(let M of Mt)l.beginPath(),l.arc(B+M.x,U+M.y,d,0,Math.PI*2),l.stroke();l.globalAlpha=1}let xn={grid:{cols:F,rows:S,colGap:_.colGap,rowGap:_.rowGap},drawDirection:J,foldStrategy:g?.type||"random",multiColor:b,showCreaseLines:O,creaseCount:Ee.length};return{dataUrl:Y.toDataURL("image/png"),settings:xn}}function be(t,e=1200,o=1697,s=0,n=null){let r=Sn(t),i=kn(e,o,s,t),p=Nn(t),u=Me(t),h=Be(t),b=Pn(t),y=b?Wn(t,r.bg,r.text):null,g=je(t),m=Yn(t),c=Xn(t),w=Hn(t),a=n;if(a===null){let f=L(t+9999);a=Math.floor(1+f()*500)}return{seed:t,palette:r,cells:i,renderMode:p,weightRange:u,foldStrategy:h,multiColor:b,levelColors:y,maxFolds:g,paperProperties:m,showCreaseLines:c,overlapInfo:w,folds:a}}function so(t,e,o,s=""){let n=be(e,1200,1697,0,o),r=Me(e),i=1200-145*2,p=1697-145*2,{creases:u}=$e(i,p,o,e,r,n.foldStrategy,n.paperProperties),h=jn(n.paperProperties);return{name:`Fold #${t}`,description:"On-chain generative paper folding art",image:s?`${s}/${t}`:"",attributes:[{trait_type:"Fold Strategy",value:n.foldStrategy.type},{trait_type:"Render Mode",value:n.renderMode},{trait_type:"Multi-Color",value:n.multiColor?"Yes":"No"},{trait_type:"Cell Size",value:`${n.cells.cellW}x${n.cells.cellH}`},{trait_type:"Fold Count",value:o},{trait_type:"Max Folds",value:n.maxFolds},{trait_type:"Crease Count",value:u.length},{trait_type:"Palette Strategy",value:n.palette.strategy},{trait_type:"Paper Type",value:h},{trait_type:"Paper Grain",value:n.paperProperties.angleAffinity!==null?"Grain":"Uniform"},...n.showCreaseLines?[{trait_type:"Crease Lines",value:"Visible"}]:[]]}}async function io(t){if(!t)return!1;let e=document.createElement("style");e.textContent=`
    @font-face {
      font-family: '${qt}';
      src: url('${t}');
    }
  `,document.head.appendChild(e);try{return await document.fonts.load(`12px ${qt}`),!0}catch(o){return console.warn("Failed to load on-chain font:",o),!1}}function lo(t){if(typeof t=="number")return t;if(typeof t!="string")return 0;let e=t.replace(/^0x/,"").slice(0,16),o=BigInt("0x"+e);return Number(o%BigInt(2147483647))}function ao(){let t=window.devicePixelRatio||1,e=window.innerWidth,o=window.innerHeight,s=1/Math.sqrt(2),n,r;e/o>s?(r=o,n=Math.floor(r*s)):(n=e,r=Math.floor(n/s));let i=Math.floor(n*t),p=Math.floor(r*t);return{width:n,height:r,renderWidth:i,renderHeight:p,dpr:t}}var mt=null;function We(t,e){if(t===0)return"none";let o=t/e;return o<0?`${Math.round(o*100)}% overlap`:`${Math.round(o*100)}% gap`}var xe=!1,ht=!1,zt=0,he=null,Kt=null;function co(t,e,o={}){let{foldOverride:s,linesOnly:n=!1,isAnimating:r=!1,width:i,height:p,showOverlays:u,gapOverrides:h=null}=o,b=i&&p?{renderWidth:i,renderHeight:p,width:i,height:p}:ao(),y=s!==void 0?s:e.foldCount,g=u!==void 0?u:r?n:n||xe,{dataUrl:m,settings:c}=ze({folds:y,seed:e.seed,outputWidth:b.renderWidth,outputHeight:b.renderHeight,bgColor:e.params.palette.bg,textColor:e.params.palette.text,accentColor:e.params.palette.accent,cellWidth:e.params.cells.cellW,cellHeight:e.params.cells.cellH,renderMode:e.params.renderMode,multiColor:e.params.multiColor,levelColors:e.params.levelColors,foldStrategy:e.params.foldStrategy,paperProperties:e.params.paperProperties,showCreaseLines:e.params.showCreaseLines,showCreases:g,showIntersections:g,linesOnlyMode:n,gapOverrides:h}),w=document.getElementById("info");if(w){let f=We(c.grid.colGap,e.params.cells.cellW),x=We(c.grid.rowGap,e.params.cells.cellH),A=[`${c.grid.cols}\xD7${c.grid.rows}`,`dir:${c.drawDirection}`,`strategy:${c.foldStrategy}`];f!=="none"&&A.push(`col:${f}`),x!=="none"&&A.push(`row:${x}`),c.multiColor&&A.push("multiColor"),c.showCreaseLines&&A.push("creaseLines"),w.textContent=A.join(" | ")}let a=new Image;return a.onload=()=>{let f=t.getContext("2d");t.width=b.renderWidth*2,t.height=b.renderHeight*2,t.style.width=b.width+"px",t.style.height=b.height+"px",f.drawImage(a,0,0,t.width,t.height),typeof window<"u"&&typeof window.scaleCanvas=="function"&&window.scaleCanvas()},a.src=m,{dataUrl:m,settings:c}}function Vt(t,e,o,s,n){return co(t,e,{foldOverride:o,linesOnly:s,isAnimating:n})}function fo(t,e){let o;return function(...s){clearTimeout(o),o=setTimeout(()=>t.apply(this,s),e)}}async function ye(){let t=typeof window<"u"&&window.SEED,e=typeof window<"u"&&window.FOLD_COUNT,o=typeof window<"u"&&window.LESS_SEED;if(o&&!t&&(t=lo(o)),t&&e===void 0){let n=L(t+9999);e=Math.floor(1+n()*500)}let s=typeof window<"u"&&window.FONT_DATA_URI||Pe;if(t&&e!==void 0){let i=function(){if(!ht||zt>e){u();return}Vt(n,mt,zt,he==="lines-only",!0),zt++,Kt=setTimeout(i,50)},p=function(h){ht=!0,zt=0,he=h,i()},u=function(){ht=!1,he=null,Kt&&(clearTimeout(Kt),Kt=null)},n=document.getElementById("c")||document.querySelector("canvas");n||(n=document.createElement("canvas"),n.id="c",document.body.appendChild(n),document.body.style.cssText="margin:0;padding:0;background:#000;display:flex;align-items:center;justify-content:center;min-height:100vh;overflow:hidden;"),await io(s);let r=be(t,1200,1697,0,e);mt={seed:t,foldCount:e,params:r},Vt(n,mt),window.addEventListener("resize",fo(()=>{mt&&!ht&&Vt(n,mt)},150)),document.addEventListener("keydown",h=>{mt&&(h.shiftKey&&h.key==="F"&&(h.preventDefault(),xe=!xe,ht||Vt(n,mt)),h.shiftKey&&h.key==="A"&&(h.preventDefault(),ht&&u(),p("full")),h.shiftKey&&h.key==="L"&&(h.preventDefault(),ht&&u(),p("lines-only")),h.key==="Escape"&&ht&&(h.preventDefault(),u()))})}}typeof window<"u"&&(window.SEED||window.FOLD_COUNT!==void 0||window.LESS_SEED)&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>ye()):ye());})();
