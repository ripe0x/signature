(()=>{var $t="FoldMono",De="data:font/woff2;charset=utf-8;base64,d09GMgABAAAAAAOIAA4AAAAADAQAAAM2AAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGhYbEBwmBmAAPBEQCo9sjiABNgIkAwwLDAAEIAWCfAcgGzkKIK4GbGOy2GicLj5u8RpRKYyZuIy26Oe9GkG0llXPQhAUoVLRQOiIjYYnUuLluRfqlUh8nv35d3DbeacPRpI7wLzuWl2XGTr+R4rdqk48ecPEg8A0wvynUz9VJ0gGYLd1C/5xl7xv3SZnBWzBGr8QtP8P9KU3gF/4v///XtV/LeBjv+MBmzYJYqG96Ce0h6/5XmbHBNnLAlygYMFqXKAK1bYRcgkLxgZhXaf627YE6gFJIBcCteo1AuwbDBChbA4tEHHa8CDi2utCBABSXokNorp4phkhurc/Cdkmqp0bWqrKalIqUp4jaAbAzD4U5MOrPfX1JpR/yDVAQLZF3YE+VCRkaEcRaEc1Bkq5kJLE/gHUNnm3+zdMKK9aMhR+h189BajFT9I/lJ0BIAcwLMQ2l3Yj73wvYnyWbjmo3XbjJ0eY8W5h/BrjMzLJ2VlnUo3PYuKqtuQN3OLm3X+/upK1DTdwjZsDyUyqec6GEF09syI3F92yUZdMJ62DE7XK6uCueMYse9occDNSOJk2TzuvAA1ohsS27Vw8Tqt1nSmHabjbFnGndFO5K3PzpJ4CUz1JBorMmHHLdmQwBHRTnMkKhQ2QvVOwlGW8DcP5FqbrJJvdjsuaDB97D7UPuQfMWVxWiURGZPMptIkVhKEJKCNQDIyTFKlyZLbV+p53gX4egWr7bX73rYYTy+fRt6NAzImHc31/acg9fC0EFH1/obMyd7VtOx4JfU3acYK4OL1wfhzUFbtqf+2dJ+YG3K/voIAkorej7to5G4ZgZG5J17dlDgasZyO9xT2bOM2geuh5N335H/05CBAo+D8a3teHrs9kVYNvlTICfznXj/qG+mEqQY0AQfnnlyCvvGfUD0jWq5FXOCj0rhgQshT513IJVZZQRF6DIzii0KmJkkZPKLNkNZ7LUKHHe3ulrkb3x2Kgo2PDk1VXwRPT09UzttAnIRgd6m8KBWMNkbgGj19b25mmG2vqxkaEs7LdVDE0VVGmSeKcTHfjguaJm3smpWsmdnzBsDSJIzDqMKW8o1bEecw0dHS0TGzyS4Z6n9NTNSaXDzlPw2BeyPLakJQRk0Wx9HurZUEAAA==",bn='"Courier New", Courier, monospace',ke=`"${$t}", ${bn}`,He=.6,ce=.08,fe=.06,En=.03,wn=.05;function Ce(t,e,r){let s=t/255,n=e/255,o=r/255;return(.2126*s+.7152*n+.0722*o)*100}var Y=[{hex:"#000000",name:"black",luminance:0,temperature:"neutral",r:0,g:0,b:0},{hex:"#0000AA",name:"blue",luminance:10,temperature:"cool",r:0,g:0,b:170},{hex:"#AA0000",name:"red",luminance:20,temperature:"warm",r:170,g:0,b:0},{hex:"#AA00AA",name:"magenta",luminance:25,temperature:"warm",r:170,g:0,b:170},{hex:"#FFFFFF",name:"white",luminance:100,temperature:"neutral",r:255,g:255,b:255},{hex:"#FFFF55",name:"yellow",luminance:93,temperature:"warm",r:255,g:255,b:85},{hex:"#55FFFF",name:"lightCyan",luminance:85,temperature:"cool",r:85,g:255,b:255},{hex:"#55FF55",name:"lightGreen",luminance:77,temperature:"cool",r:85,g:255,b:85},{hex:"#00AA00",name:"green",luminance:30,temperature:"cool",r:0,g:170,b:0},{hex:"#00AAAA",name:"cyan",luminance:40,temperature:"cool",r:0,g:170,b:170},{hex:"#5555FF",name:"lightBlue",luminance:45,temperature:"cool",r:85,g:85,b:255},{hex:"#FF5555",name:"lightRed",luminance:45,temperature:"warm",r:255,g:85,b:85},{hex:"#FF55FF",name:"lightMagenta",luminance:60,temperature:"warm",r:255,g:85,b:255}],Rn=Y.filter(t=>t.luminance<30||t.luminance>70),Cn={black:.2,white:.15,blue:.15,red:.15,magenta:.1,yellow:.1,lightCyan:.08,lightGreen:.07},wt=Y,Tn=Y.filter(t=>t.temperature!=="neutral"),In=Y.filter(t=>t.temperature!=="neutral"),Te=Y,yo={dark:Y.filter(t=>t.luminance<30),light:Y.filter(t=>t.luminance>70)},Ie={warm:Y.filter(t=>t.temperature==="warm"),cool:Y.filter(t=>t.temperature==="cool"),neutral:Y.filter(t=>t.temperature==="neutral")};function Fn(t,e,r){let s=t.luminance,n=e.luminance,o=[];for(let l=0;l<r;l++){let h=l/(r-1),f=s+(n-s)*h,g=Y.filter(A=>A.temperature===t.temperature||A.temperature==="neutral"),p=g[0],x=Math.abs(p.luminance-f);for(let A of g){let d=Math.abs(A.luminance-f);d<x&&(x=d,p=A)}o.push(p)}return o}function Fe(t,e,r=4.5){let s=t.luminance/100,n=e.luminance/100,o=Math.max(s,n)+.05,l=Math.min(s,n)+.05;return o/l>=r}function Vt(t,e){return e[Math.floor(t()*e.length)]}function vn(t,e,r){let s=t(),n=0;for(let o of e)if(n+=r[o.name]||0,s<n)return o;return e[e.length-1]}function Ut(t,e,r){e/=100,r/=100;let s=e*Math.min(r,1-r),n=o=>{let l=(o+t/30)%12,h=r-s*Math.max(Math.min(l-3,9-l,1),-1);return Math.round(255*h).toString(16).padStart(2,"0")};return`#${n(0)}${n(8)}${n(4)}`}function _t(t){let e=parseInt(t.slice(1,3),16)/255,r=parseInt(t.slice(3,5),16)/255,s=parseInt(t.slice(5,7),16)/255,n=Math.max(e,r,s),o=Math.min(e,r,s),l,h,f=(n+o)/2;if(n===o)l=h=0;else{let g=n-o;switch(h=f>.5?g/(2-n-o):g/(n+o),n){case e:l=((r-s)/g+(r<s?6:0))/6;break;case r:l=((s-e)/g+2)/6;break;case s:l=((e-r)/g+4)/6;break}}return{h:l*360,s:h*100,l:f*100}}var Gn={red:["cyan","lightCyan"],magenta:["green","lightGreen"],blue:["yellow"],lightRed:["cyan","lightCyan"],lightMagenta:["green","lightGreen"],lightBlue:["yellow"],cyan:["red","lightRed"],lightCyan:["red","lightRed"],green:["magenta","lightMagenta"],lightGreen:["magenta","lightMagenta"],yellow:["blue","lightBlue"],black:["white","yellow","lightCyan"],white:["black","blue","magenta"]};function On(t,e,r){let n=[];switch(e){case"value":{let o=t.luminance<50;n=wt.filter(l=>o?l.luminance>60:l.luminance<40);break}case"temperature":{if(t.temperature==="neutral")n=wt.filter(o=>o.temperature!=="neutral"&&Math.abs(o.luminance-t.luminance)>25);else{let o=t.temperature==="warm"?"cool":"warm";n=wt.filter(l=>l.temperature===o&&Math.abs(l.luminance-t.luminance)>25)}break}case"complement":{let o=Gn[t.name]||[];if(n=wt.filter(l=>o.includes(l.name)),n.length===0){let l=t.luminance<50;n=wt.filter(h=>l?h.luminance>60:h.luminance<40)}break}case"clash":{n=wt.filter(o=>o.name!==t.name&&Math.abs(o.luminance-t.luminance)>20&&Math.abs(o.luminance-t.luminance)<50);break}}return n.sort((o,l)=>Math.abs(l.luminance-t.luminance)-Math.abs(o.luminance-t.luminance)),n.length>0?Vt(r,n):t.luminance<50?Y.find(o=>o.name==="white"):Y.find(o=>o.name==="black")}function _n(t,e,r){if(r()<.4)return e;let s=Tn.filter(o=>o.name!==t.name&&o.name!==e.name&&Math.abs(o.luminance-t.luminance)>20);if(s.length===0)return e;let n=s.filter(o=>["yellow","lightCyan","lightMagenta","lightGreen"].includes(o.name));return n.length>0&&r()<.6?Vt(r,n):Vt(r,s)}function Ln(t){let e=Vt(t,In),r;return e.luminance>50?r=Y.find(s=>s.name==="black"):e.luminance<30?r=t()<.75?Y.find(s=>s.name==="black"):Y.find(s=>s.name==="white"):r=t()<.6?Y.find(s=>s.name==="black"):Y.find(s=>s.name==="white"),{bg:r.hex,text:e.hex,accent:e.hex,strategy:`monochrome/${e.name}`,colorCount:2}}function Nn(t){let e=L(t);if(e()<.12)return Ln(e);let r=vn(e,Rn,Cn),s=e(),n;s<.4?n="value":s<.68?n="temperature":s<.9?n="complement":n="clash";let o=On(r,n,e),l=_n(r,o,e),h=l.hex===o.hex?2:3;return Math.abs(r.luminance-o.luminance)<25?{bg:r.luminance<50?"#000000":"#FFFFFF",text:r.luminance<50?"#FFFFFF":"#000000",accent:"#FFFF55",strategy:n,colorCount:h}:{bg:r.hex,text:o.hex,accent:l.hex,strategy:n,colorCount:h}}function ve(t,e,r){let s=[];for(let n=e;n<=r;n++)t%n===0&&s.push(n);return s}function Dn(t,e,r,s){let n=1200-r*2-290,o=1697-r*2-145*2,l=ve(n,20,600),h=ve(o,20,600);l.length===0&&l.push(8),h.length===0&&h.push(12);let f=L(s+9999),g=1+ce+fe,p=He/g,x=[];for(let c of l)for(let b of h){let a=Math.max(c/b,b/c),u=b*p;a<=3&&c>=u&&x.push({w:c,h:b})}if(x.length===0)return{cellW:8,cellH:12};x.sort((c,b)=>c.w*c.h-b.w*b.h);let A=f(),d;if(A<.03){let c=Math.max(1,Math.ceil(x.length*.1)),b=Math.floor(f()*c);d=x[b]}else if(A<.1){let c=Math.floor(x.length*.1),b=Math.floor(x.length*.25),a=c+Math.floor(f()*Math.max(1,b-c));d=x[Math.min(a,x.length-1)]}else if(A<.45){let c=Math.floor(x.length*.25),b=Math.floor(x.length*.75),a=c+Math.floor(f()*(b-c));d=x[Math.min(a,x.length-1)]}else if(A<.95){let c=Math.floor(x.length*.75),b=Math.floor(x.length*.9),a=c+Math.floor(f()*Math.max(1,b-c));d=x[Math.min(a,x.length-1)]}else{let c=Math.floor(x.length*.9),b=c+Math.floor(f()*(x.length-c));d=x[Math.min(b,x.length-1)]}return{cellW:d.w,cellH:d.h}}function kn(t){let r=L(t+5555)();return r<.35?"normal":r<.4?"binary":r<.75?"inverted":r<.975?"sparse":"dense"}function ge(t){let e=L(t+7777),r=e();if(r<.25){let s=.2+e()*.2;return{min:s,max:s+.1+e()*.2}}else if(r<.5){let s=.6+e()*.2;return{min:s,max:s+.1+e()*.1}}else return r<.75?{min:.1+e()*.2,max:.7+e()*.3}:{min:.3+e()*.2,max:.5+e()*.5}}function Hn(t){let e=L(t+11111);if(!(e()>=.5))return{hasOverlap:!1,amount:"none"};let s=e(),n;return s<.2?n="5%":s<.4?n="25%":s<.6?n="50%":s<.8?n="75%":n="95%",{hasOverlap:!0,amount:n}}function Se(t){let e=L(t+2222);return Math.floor(4+e()*66)}function We(t){let e=L(t+6666),r=e();return r<.16?{type:"horizontal",jitter:3+e()*12}:r<.32?{type:"vertical",jitter:3+e()*12}:r<.44?{type:"diagonal",angle:e()<.5?45:135,jitter:5+e()*15}:r<.56?{type:"radial",focalX:.2+e()*.6,focalY:.2+e()*.6}:r<.68?{type:"grid",jitter:3+e()*10}:r<.8?{type:"clustered",clusterX:.15+e()*.7,clusterY:.15+e()*.7,spread:.2+e()*.4}:{type:"random"}}function Ge(t){let e=t.toUpperCase();return Te.find(r=>r.hex===e)||Te[0]}function Sn(t,e,r){let s=L(t+3333),n=Ge(e),o=Ge(r),l=n.luminance>50,h=(g,p)=>l?p.luminance-g.luminance:g.luminance-p.luminance;if(s()<.5){let g=Fn(n,o,6);return[g[0].hex,g[Math.floor(g.length*.33)].hex,g[Math.floor(g.length*.66)].hex,g[g.length-1].hex]}else{let g=o.temperature,p=g==="warm"?"cool":"warm",x=Ie[g].filter(y=>Fe(n,y,2)).sort(h),A=Ie[p].filter(y=>Fe(n,y,2)).sort(h),d=[],c=new Set;x.length>0?(d.push(x[0].hex),c.add(x[0].hex)):(d.push(o.hex),c.add(o.hex));let b=x.filter(y=>!c.has(y.hex));if(b.length>0){let y=b[Math.floor(b.length*.4)];d.push(y.hex),c.add(y.hex)}else d.push(o.hex);let a=A.filter(y=>!c.has(y.hex));if(a.length>0){let y=a[Math.floor(a.length*.5)];d.push(y.hex),c.add(y.hex)}else d.push(o.hex);let u=[...x,...A].filter(y=>!c.has(y.hex)).sort(h);return u.length>0?d.push(u[u.length-1].hex):d.push(o.hex),d}}function Wn(t){return L(t+4444)()<.25}function Pn(t){return L(t+9191)()<.008}function jn(t){let e=L(t+5555),r=.1+e()*.8,s=0,n=e()<.4,o=n?e()*180:null,l=n?.2+e()*.6:0,h=.3+e()*1.4;return{absorbency:r,intersectionThreshold:s,angleAffinity:o,affinityStrength:l,ceilingMultiplier:h}}function Bn(t){let e=t.absorbency<.35?"Resistant":t.absorbency<.65?"Standard":"Absorbent",r=t.intersectionThreshold<.15?"Fine":t.intersectionThreshold<.35?"Medium":"Coarse",s=t.angleAffinity!==null?"Grain":"Uniform";return`${e}/${r}/${s}`}function Xn(t,e,r){return t}var Oe=[-1/1,-1/2,-1/4,-1/8,-1/16,1/64,1/32,1/16,1/8,1/4,1/2,1,2];function Yn(t,e,r,s,n){let o=L(t+12345),l=o()<.6,h=!1,f=!1,g=!1,p=!1;if(l){let T=o();T<.33?h=!0:(T<.66||(h=!0),f=!0),h&&o()<.3&&(g=!0),f&&o()<.3&&(p=!0)}let x=[-1/16,-1/8,-1/4,-1/2],A=T=>{if(T)return x;let X=Oe.slice(5,12);return o()<.1&&X.push(Oe[12]),X},d=e,c=r,b=1,a=0,u=1/0;if(g){let T=x[Math.floor(o()*x.length)],X=d*T,W=d+X;W>0&&(b=Math.max(1,Math.floor((s+X)/W)),a=X)}else{let T=h?A(!1):[0];for(let X of T){let W=d*X,K=d+W;if(K<=0)continue;let _=Math.max(1,Math.floor((s+W)/K));if(_===1){let k=Math.min(d,s),N=Math.abs(s-k);N<u&&(u=N,b=1,a=0,d=k)}else{let k=_*d+(_-1)*W;if(k<=s){let N=Math.abs(s-k);N<u&&(u=N,b=_,a=W)}}}b===1&&d<s&&(d=s,a=0)}let y=1,E=0,I=1/0;if(p){let T=x[Math.floor(o()*x.length)],X=c*T,W=c+X;W>0&&(y=Math.max(1,Math.floor((n+X)/W)),E=X)}else{let T=f?A(!1):[0];for(let X of T){let W=c*X,K=c+W;if(K<=0)continue;let _=Math.max(1,Math.floor((n+W)/K));if(_===1){let k=Math.min(c,n),N=Math.abs(n-k);N<I&&(I=N,y=1,E=0,c=k)}else{let k=_*c+(_-1)*W;if(k<=n){let N=Math.abs(n-k);N<I&&(I=N,y=_,E=W)}}}}y===1&&c<n&&(c=n,E=0);let C=b,G=y,v=a,O=E,U=C*d+(C>1?(C-1)*v:0),i=G*c+(G>1?(G-1)*O:0),B=s-U,F=n-i;return{cols:C,rows:G,cellWidth:d,cellHeight:c,colGap:v,rowGap:O,strideX:d+v,strideY:c+O,gridOffsetX:B>0?B/2:0,gridOffsetY:F>0?F/2:0,actualGridWidth:U,actualGridHeight:i}}function Un(t){let e=Object.values(t).filter(h=>h>0);if(e.length===0)return{t1:1,t2:2,t3:3,tExtreme:999};e.sort((h,f)=>h-f);let r=(h,f)=>{let g=Math.floor(h.length*f);return h[Math.min(g,h.length-1)]},s=r(e,.7),n=r(e,.94),o=r(e,.94)+1,l=r(e,.985);return{t1:Math.max(.01,s),t2:Math.max(s+.01,n),t3:Math.max(n+.01,o),tExtreme:Math.max(o+.01,l)}}function Rt(t,e){return t===0?0:t<=e.t1?1:t<=e.t2?2:3}var Kn=1103515245n,zn=12345n,_e=0x7fffffffn;function L(t){let e=BigInt(Math.abs(t)||1);return()=>(e=e*Kn+zn&_e,Number(e)/Number(_e))}var j={add:(t,e)=>({x:t.x+e.x,y:t.y+e.y}),sub:(t,e)=>({x:t.x-e.x,y:t.y-e.y}),scale:(t,e)=>({x:t.x*e,y:t.y*e}),dot:(t,e)=>t.x*e.x+t.y*e.y,len:t=>Math.sqrt(t.x*t.x+t.y*t.y),dist:(t,e)=>j.len(j.sub(t,e)),norm:t=>{let e=j.len(t);return e>1e-4?j.scale(t,1/e):{x:0,y:0}},perp:t=>({x:-t.y,y:t.x}),mid:(t,e)=>({x:(t.x+e.x)/2,y:(t.y+e.y)/2}),lerp:(t,e,r)=>({x:t.x+(e.x-t.x)*r,y:t.y+(e.y-t.y)*r}),copy:t=>({x:t.x,y:t.y}),eq:(t,e)=>j.dist(t,e)<.5};function me(t,e,r,s){let n=j.sub(e,t),o=j.sub(s,r),l=n.x*o.y-n.y*o.x;if(Math.abs(l)<1e-4)return null;let h=j.sub(r,t),f=(h.x*o.y-h.y*o.x)/l,g=(h.x*n.y-h.y*n.x)/l;return f>=.001&&f<=.999&&g>=.001&&g<=.999?{point:j.add(t,j.scale(n,f)),t:f,u:g}:null}function Le(t,e){let r=t.reduce((n,o)=>n+o,0);if(r<=0)return 0;let s=e()*r;for(let n=0;n<t.length;n++)if(s-=t[n],s<=0)return n;return t.length-1}var $n=0,Vn=1,qn=2,Jn=3;function ot(t,e,r,s){switch(t){case $n:return{x:e*r,y:0};case Vn:return{x:r,y:e*s};case qn:return{x:(1-e)*r,y:s};case Jn:return{x:0,y:(1-e)*s};default:return{x:e*r,y:0}}}function ue(t,e,r){switch(t){case 0:return{x:0,y:0};case 1:return{x:e,y:0};case 2:return{x:e,y:r};case 3:return{x:0,y:r};default:return{x:0,y:0}}}function Pe(t,e){return{x:t.p1.x+(t.p2.x-t.p1.x)*e,y:t.p1.y+(t.p2.y-t.p1.y)*e}}function he(t,e){let r=e.x-t.x,s=e.y-t.y,n=Math.atan2(s,r)*180/Math.PI;return n<0&&(n+=180),n>=180&&(n-=180),n}function Qn(t,e,r,s,n,o,l){let f=(()=>{if(!l)return[0,1,2,3];switch(l.type){case"horizontal":return[1,3];case"vertical":return[0,2];case"grid":return t%2===0?[1,3]:[0,2];case"diagonal":return[0,1,2,3];case"radial":case"clustered":case"random":default:return[0,1,2,3]}})();if(l&&l.type==="radial"){let A=l.focalX*s,d=l.focalY*n;if(t<10||e.length===0||o()<.6){let c=[{edge:0,dist:d},{edge:1,dist:s-A},{edge:2,dist:n-d},{edge:3,dist:A}];c.sort((y,E)=>y.dist-E.dist);let b=o(),a=b<.5?c[0].edge:b<.8?c[1].edge:c[Math.floor(o()*4)].edge,u;return a===0||a===2?u=.1+A/s*.8+(o()-.5)*.3:u=.1+d/n*.8+(o()-.5)*.3,u=Math.max(.05,Math.min(.95,u)),{point:ot(a,u,s,n),type:"edge",edge:a,t:u}}}if(l&&l.type==="clustered"){let A=l.clusterX*s,d=l.clusterY*n,c=l.spread;if(t<15||o()<.7){let b=[{edge:0,weight:1+(1-Math.abs(d/n))*2},{edge:1,weight:1+A/s*2},{edge:2,weight:1+d/n*2},{edge:3,weight:1+(1-A/s)*2}],a=b.reduce((I,C)=>I+C.weight,0),u=o()*a,y=0;for(let I of b)if(u-=I.weight,u<=0){y=I.edge;break}let E;return y===0||y===2?E=A/s+(o()-.5)*c:E=d/n+(o()-.5)*c,E=Math.max(.05,Math.min(.95,E)),{point:ot(y,E,s,n),type:"edge",edge:y,t:E}}}let g=Math.max(.2,1-t*.015),p=l&&(l.type==="horizontal"||l.type==="vertical"||l.type==="grid");if(p||o()<g||e.length===0&&r.length===0){let A=p?0:l&&l.type==="diagonal"?.5:.15;if(o()<A){let c=Math.floor(o()*4);return{point:ue(c,s,n),type:"corner",corner:c}}else{let c=f[Math.floor(o()*f.length)],b=l&&l.jitter?l.jitter/100:0,a=.05+o()*.9,u=Math.max(.05,Math.min(.95,a+(o()-.5)*b));return{point:ot(c,u,s,n),type:"edge",edge:c,t:u}}}else if(r.length>0&&o()<.35){let d=r[Math.floor(o()*r.length)];return{point:{x:d.x,y:d.y},type:"intersection",intersectionIndex:r.indexOf(d)}}else if(e.length>0){let d=e[Math.floor(o()*e.length)],c=.1+o()*.8;return{point:Pe(d,c),type:"crease",creaseIndex:e.indexOf(d),t:c}}else{let d=f[Math.floor(o()*f.length)],c=.05+o()*.9;return{point:ot(d,c,s,n),type:"edge",edge:d,t:c}}}function Zn(t,e,r,s,n,o,l,h,f){let g=Math.min(n,o)*.15,p=a=>a===0||a===2,x=a=>a===1||a===3;if(f&&(f.type==="horizontal"||f.type==="vertical"||f.type==="grid")){let a=f.type==="horizontal"||f.type==="grid"&&e%2===0;if(t.type==="edge"){let u=(t.edge+2)%4,y=x(t.edge);if(a&&y||!a&&!y){let E=f.jitter?f.jitter/100:0,I=t.t!==void 0?t.t:.5,C=Math.max(.05,Math.min(.95,I+(l()-.5)*E));return C=1-C,{point:ot(u,C,n,o),type:"edge",edge:u}}}}if(f&&f.type==="diagonal"){let a=f.angle||(l()<.5?45:135);if(t.type==="corner"){let u=(t.corner+2)%4;return{point:ue(u,n,o),type:"corner"}}else if(t.type==="edge"){let u=f.jitter?(l()-.5)*f.jitter:0,y=(a+u)*Math.PI/180,E=t.point.x,I=t.point.y,C=Math.cos(y),G=Math.sin(y),v=null,O=0,U=[{edge:0,y:0},{edge:2,y:o},{edge:3,x:0},{edge:1,x:n}];for(let i of U){let B=null;if(i.y!==void 0){let F=(i.y-I)/G;if(F>0){let T=E+C*F;T>=0&&T<=n&&(B={x:T,y:i.y})}}else{let F=(i.x-E)/C;if(F>0){let T=I+G*F;T>=0&&T<=o&&(B={x:i.x,y:T})}}if(B){let F=j.dist(t.point,B);F>O&&F>=g&&(O=F,v=B)}}if(v)return{point:v,type:"edge"}}}if(f&&f.type==="radial"){let a=f.focalX*n,u=f.focalY*o,y={x:a,y:u},E=t.point.x-a,I=t.point.y-u,C=Math.sqrt(E*E+I*I);if(C>0){let G=E/C,v=I/C,O=1/0;G>0&&(O=Math.min(O,(n-t.point.x)/G)),G<0&&(O=Math.min(O,-t.point.x/G)),v>0&&(O=Math.min(O,(o-t.point.y)/v)),v<0&&(O=Math.min(O,-t.point.y/v));let U={x:Math.max(0,Math.min(n,t.point.x+G*O*.95)),y:Math.max(0,Math.min(o,t.point.y+v*O*.95))};if(j.dist(t.point,U)>=g)return{point:U,type:"edge"}}}if(f&&f.type==="clustered"){let a=f.clusterX*n,u=f.clusterY*o,y={x:a,y:u},E=[];for(let C=0;C<4;C++)for(let G=0;G<3;G++){let v=.1+l()*.8,O=ot(C,v,n,o),U=to(y,t.point,O),i=Math.max(n,o)*.5,B=Math.max(.1,1-U/i)*3;E.push({point:O,type:"edge",edge:C,weight:B})}let I=E.filter(C=>j.dist(t.point,C.point)>=g);if(I.length>0){let C=I.map(v=>v.weight),G=Le(C,l);return I[G]}}let A=[];if(t.type==="edge"){let a=(t.edge+2)%4,u=(t.edge+1)%4,y=(t.edge+3)%4,E=e<3?3:1.5;for(let C=0;C<3;C++){let G=.1+l()*.8;A.push({point:ot(a,G,n,o),type:"edge",edge:a,weight:E})}let I=1;for(let C=0;C<2;C++){let G=.1+l()*.8;A.push({point:ot(u,G,n,o),type:"edge",edge:u,weight:I}),A.push({point:ot(y,G,n,o),type:"edge",edge:y,weight:I})}}else if(t.type==="corner"){let a=(t.corner+2)%4;A.push({point:ue(a,n,o),type:"corner",weight:2});for(let u=0;u<4;u++)if(!(u===t.corner||u===(t.corner+3)%4)){let E=.2+l()*.6;A.push({point:ot(u,E,n,o),type:"edge",edge:u,weight:1.5})}}else{for(let a=0;a<4;a++){let u=.1+l()*.8;A.push({point:ot(a,u,n,o),type:"edge",edge:a,weight:1})}if(r.length>1&&e>3)for(let a=0;a<Math.min(3,r.length);a++){let u=Math.floor(l()*r.length),y=r[u];if(t.type==="crease"&&t.creaseIndex===u)continue;let E=.15+l()*.7;A.push({point:Pe(y,E),type:"crease",creaseIndex:u,weight:.6})}}if(r.length>0&&h)for(let a of A){let u=he(t.point,a.point);for(let y of r){let E=he(y.p1,y.p2),I=Math.abs(u-E);I>90&&(I=180-I),h.parallel>0&&I<15&&(a.weight*=1+h.parallel),h.perpendicular>0&&I>75&&(a.weight*=1+h.perpendicular)}}let d=A.filter(a=>j.dist(t.point,a.point)>=g);if(d.length===0){for(let u=0;u<4;u++){let E=ot(u,.5,n,o);if(j.dist(t.point,E)>=g)return{point:E,type:"edge",edge:u}}let a=t.type==="edge"?(t.edge+2)%4:0;return{point:ot(a,.5,n,o),type:"edge",edge:a}}let c=d.map(a=>a.weight),b=Le(c,l);return d[b]}function to(t,e,r){let s=r.x-e.x,n=r.y-e.y,o=s*s+n*n;if(o===0)return j.dist(t,e);let l=((t.x-e.x)*s+(t.y-e.y)*n)/o;l=Math.max(0,Math.min(1,l));let h={x:e.x+l*s,y:e.y+l*n};return j.dist(t,h)}function eo(t){let e=[];for(let r=0;r<t.length;r++)for(let s=r+1;s<t.length;s++){let n=me(t[r].p1,t[r].p2,t[s].p1,t[s].p2);n&&e.push({x:n.point.x,y:n.point.y,crease1:r,crease2:s})}return e}function je(t,e,r,s,n={min:0,max:1},o=null,l=null){if(!t||!e||t<=0||e<=0)return{creases:[],finalShape:[]};let h=o||We(s),f=Se(s),g=[{x:0,y:0},{x:t,y:0},{x:t,y:e},{x:0,y:e}],p=[],x=null,A=null;if(!r||r<=0)return{creases:[],finalShape:g,maxFolds:f,firstFoldTarget:null,lastFoldTarget:null};let d=L(s),c=L(s+8888),b=L(s+6666),a=l||{absorbency:1,intersectionThreshold:0,angleAffinity:null,affinityStrength:0,ceilingMultiplier:1},u=[],y=L(s+1111);for(let v=0;v<f;v++)u[v]=.001+y()*.25;let E=L(s+2222),I={parallel:E()*.8,perpendicular:E()*.8},C=Math.max(t,e)*.05,G=[];for(let v=0;v<r;v++){let O=v%f,U=Math.floor(v/f);if(O===0&&U>0)for(let N of p)N.reductionMultiplier!==void 0&&(N.weight=Math.max(.01,N.weight*N.reductionMultiplier));v%5===0&&p.length>1&&(G=eo(p));let i=Qn(v,p,G,t,e,d,h),B=Zn(i,v,p,G,t,e,d,I,h),F=i.point,T=B.point,W=b()<a.absorbency,K=n.min+c()*(n.max-n.min);if(a.angleAffinity!==null&&a.affinityStrength>0){let N=he(F,T),Q=Math.abs(N-a.angleAffinity);Q>90&&(Q=180-Q);let ut=1-Q/90*a.affinityStrength;K*=ut}if(W&&K>.01&&(p.push({p1:j.copy(F),p2:j.copy(T),depth:p.length,weight:K,cyclePosition:O,reductionMultiplier:u[O],anchorType:i.type,terminusType:B.type}),p.length>1)){let N=p[p.length-1];for(let Q=0;Q<p.length-1;Q++){let ut=me(N.p1,N.p2,p[Q].p1,p[Q].p2);ut&&G.push({x:ut.point.x,y:ut.point.y,crease1:Q,crease2:p.length-1})}}let _=j.mid(F,T),k={x:Math.max(C,Math.min(t-C,_.x)),y:Math.max(C,Math.min(e-C,_.y))};v===0&&x===null&&(x=k),A=k}return{creases:p,finalShape:g,maxFolds:f,firstFoldTarget:x,lastFoldTarget:A}}function no(t){let e=[];for(let r=0;r<t.length;r++)for(let s=r+1;s<t.length;s++){let n=me(t[r].p1,t[r].p2,t[s].p1,t[s].p2);if(n){let o=t[r].weight||1,l=t[s].weight||1;e.push({x:n.point.x,y:n.point.y,depth1:t[r].depth,depth2:t[s].depth,gap:Math.abs(t[s].depth-t[r].depth),weight:o+l})}}return e}function oo(t,e,r,s,n,o=null,l=null){let h=no(t),f=l||{intersectionThreshold:0,ceilingMultiplier:1},g=h.filter(a=>a.weight>=f.intersectionThreshold),p={},x={},A={};for(let a of g){let u=Math.floor(a.x/s),y=Math.floor(a.y/n);if(u>=0&&u<e&&y>=0&&y<r){let E=`${u},${y}`;p[E]=(p[E]||0)+a.weight,x[E]=Math.max(x[E]||0,a.gap),A[E]=(A[E]||0)+1}}let c=e*r*.5*f.ceilingMultiplier,b=Object.values(p).reduce((a,u)=>a+u,0);if(b>c&&b>0){let a=c/b,u=a+(1-a)*.3;for(let y of Object.keys(p))p[y]*=u}return{activeCreases:t,intersections:g,cellWeights:p,cellMaxGap:x,cellIntersectionCounts:A,destroyed:0,maxFolds:o}}function Be({folds:t,seed:e,outputWidth:r,outputHeight:s,bgColor:n,textColor:o,accentColor:l,cellWidth:h,cellHeight:f,renderMode:g,multiColor:p,levelColors:x,foldStrategy:A=null,paperProperties:d=null,padding:c=0,showCreases:b=!1,showPaperShape:a=!1,showFoldTargets:u=!1,showIntersections:y=!1,showGrid:E=!1,showHitCounts:I=!1,showCellOutlines:C=!1,showCreaseLines:G=!1,fontFamily:v=ke,linesOnlyMode:O=!1}){let U=document.createElement("canvas"),i=U.getContext("2d"),B=2;U.width=r*B,U.height=s*B,i.setTransform(B,0,0,B,0,0),i.fillStyle=n,i.fillRect(0,0,r,s);let F=r/1200,T=s/1697,X=1200-c*2-145*2,W=1697-c*2-145*2,K=Yn(e,h,f,X,W),{cols:_,rows:k,strideX:N,strideY:Q,gridOffsetX:ut,gridOffsetY:Ye}=K,Ue=K.cellWidth,Ke=K.cellHeight,ye=X*F,qt=W*T,z=(c+145+ut)*F,$=(c+145+Ye)*T,Ct=Ue*F,Dt=Ke*T,Tt=N*F,It=Q*T,ze=ge(e),$e=Xn(d,_,k),Ve=K.actualGridWidth,qe=K.actualGridHeight,{creases:Me,finalShape:Je,maxFolds:Qe,firstFoldTarget:mt,lastFoldTarget:xt}=je(Ve,qe,t,e,ze,A,$e),Ze=Me.map(m=>({...m,p1:{x:m.p1.x*F,y:m.p1.y*T},p2:{x:m.p2.x*F,y:m.p2.y*T}})),Jt=null;if(mt){let m=Math.max(0,Math.min(_-1,Math.floor(mt.x/N))),M=Math.max(0,Math.min(k-1,Math.floor(mt.y/Q)));Jt=`${m},${M}`}let Qt=null;if(xt){let m=Math.max(0,Math.min(_-1,Math.floor(xt.x/N))),M=Math.max(0,Math.min(k-1,Math.floor(xt.y/Q)));Qt=`${m},${M}`}let{activeCreases:Ft,intersections:Zt,cellWeights:te,cellMaxGap:ee}=oo(Ze,_,k,Tt,It,Qe,d),ht=new Set;if(Object.keys(ee).length>0){let m=Math.max(...Object.values(ee));for(let[M,w]of Object.entries(ee))w===m&&ht.add(M)}let tn=1+ce+fe,dt=Dt/tn;i.font=`${dt}px ${v}`,i.textBaseline="top";let lt=[" ","\u2591","\u2592","\u2593"],vt=dt<30?2:3,et=dt*He,en=dt*ce,nn=dt*fe,fo=dt*En,on=dt*wn,yt=Un(te),kt=L(e+22222)(),Mt;kt<.6?Mt=0:kt<.8?Mt=1:kt<.9?Mt=2:kt<.97?Mt=3:Mt=5;let Ht=L(e+33333),At=Ht(),J;At<.22?J="ltr":At<.44?J="rtl":At<.65?J="center":At<.8?J="alternate":At<.9?J="diagonal":At<.96?J="randomMid":J="checkerboard";let rn=Ht()<.5,sn=Math.floor(Ht()*_),ln=Ht()<.5,St=L(e+11111),ne=St()>=.65,an=(()=>{if(!ne)return 1;let m=St();return m<.1?.95:m<.2?.75:m<.3?.65:m<.6?.5:m<.8?.25:.05})(),cn=ne?Math.floor(St()*5):0,bt=[.95,.75,.5,.25,.05],Ae=bt.indexOf(an),Wt=Math.floor(St()*3)+1,fn=(m,M)=>{if(!ne)return 1;let w=Ae===-1?0:Ae;switch(cn){case 1:w=(w+Math.floor(m/2)*Wt)%bt.length;break;case 2:w=(w+Math.floor(M/2)*Wt)%bt.length;break;case 3:w=(w+(m+M)%2*Wt)%bt.length;break;case 4:w=(w+Math.floor((m+M)/2)*Wt)%bt.length;break;default:break}return bt[w]},ct=(m,M)=>p&&x?x[Math.min(m,3)]:o,Pt=L(e+22222),oe=Pt()<.25,un=Math.round(2+Pt()*2)*F,hn=Math.round(1+Pt()*2)*T,dn=oe?.4+Pt()*.3:0,pn=(m,M)=>{let w=L(e+22222+m*1e3+M),Z=Math.floor(w()*3);return{x:Z!==1?un:0,y:Z!==0?hn:0}},gn=oe?(()=>{let m=_t(o),M;return l&&l!==o?M=_t(l):M={h:(m.h+180)%360,s:Math.min(100,m.s+20),l:m.l},M.l<=m.l&&(M.l=Math.min(95,m.l+25)),Ut(M.h,M.s,M.l)})():null,be=(c+145)*F,re=(c+145)*T,se=be+on,mn=re+en,le=be+ye,go=re+qt-nn;if(O){let m=R=>{let D=parseInt(R.slice(1,3),16),q=parseInt(R.slice(3,5),16),S=parseInt(R.slice(5,7),16);return Ce(D,q,S)},M=m(n),w=m(o),Z=m(l),V=Math.abs(M-w)>Math.abs(M-Z)?o:l,rt=2*F;if(Ft.length>0){i.strokeStyle=V,i.lineWidth=rt,i.globalAlpha=1,i.lineCap="round";for(let R of Ft)i.beginPath(),i.moveTo(z+R.p1.x,$+R.p1.y),i.lineTo(z+R.p2.x,$+R.p2.y),i.stroke()}if(Zt&&Zt.length>0){i.strokeStyle=V,i.lineWidth=rt,i.globalAlpha=1;let R=4*F;for(let D of Zt)i.beginPath(),i.arc(z+D.x,$+D.y,R,0,Math.PI*2),i.stroke()}i.globalAlpha=1}else if(I){let m=Math.floor(Math.min(Ct*.45,Dt*.7));i.font=`bold ${m}px monospace`,i.textAlign="center",i.textBaseline="middle",i.fillStyle=o;for(let M=0;M<k;M++)for(let w=0;w<_;w++){let Z=Math.round(z+w*Tt+Ct/2),V=Math.round($+M*It+Dt/2),rt=`${w},${M}`,R=te[rt]||0;R>0&&i.fillText(Math.round(R).toString(),Z,V)}i.textAlign="left",i.textBaseline="top"}else{let m=Math.max(z,se),M=Math.max($,mn);for(let w=0;w<k;w++){let Z=Math.round(M+w*It);if(!(Z>re+qt))for(let V=0;V<_;V++){let rt=Math.round(m+V*Tt),R=`${V},${w}`,D=te[R]||0,q=null,S=o,H=-1,jt=!1;if(Jt===R)H=D>0?Rt(D,yt):2,q=lt[Math.min(Math.max(H,2),vt)],S=l;else if(g==="normal")if(H=Rt(D,yt),q=lt[Math.min(H,vt)],H===0&&(q=lt[1],jt=!0),S=ct(H,R),D>=1.5){let Et=D-1.5,pt=30+Math.min(Et*300,150),tt=_t(o);S=Ut((tt.h+pt+360)%360,Math.min(100,tt.s+20),Math.min(85,tt.l+10))}else ht.has(R)&&D>0?S=l:Qt===R&&(S=o);else if(g==="binary")D===0?(q=lt[0],H=0,S=ct(0,R)):(H=vt,q=lt[H],S=ct(H,R),ht.has(R)&&(S=l));else if(g==="inverted")if(H=Math.min(3-Rt(D,yt),vt),q=lt[H],S=ct(H,R),D>=1.5){let Et=D-1.5,pt=30+Math.min(Et*300,150),tt=_t(o);S=Ut((tt.h+pt+360)%360,Math.min(100,tt.s+20),Math.min(85,tt.l+10))}else ht.has(R)&&D>0&&(S=l);else if(g==="sparse")H=Rt(D,yt),H===1&&(q=lt[1],S=ct(1,R),ht.has(R)&&(S=l));else if(g==="dense")if(H=Rt(D,yt),H>=2)if(q=lt[Math.min(H,vt)],S=ct(H,R),D>=1.5){let Et=D-1.5,pt=30+Math.min(Et*300,150),tt=_t(o);S=Ut((tt.h+pt+360)%360,Math.min(100,tt.s+20),Math.min(85,tt.l+10))}else ht.has(R)&&(S=l);else D===0&&(q=lt[0],H=0,S=ct(0,R));if(q){if(Jt===R||Qt===R)i.fillStyle=S;else{let P=ct(Rt(D,yt),R);i.fillStyle=ht.has(R)&&D>0?l:P}jt&&(i.globalAlpha=.1,i.fillStyle=o);let Et=i.measureText(q).width,pt=rt+Ct,tt=Math.min(pt,le),Gt=tt-rt;if(Gt<et*.5)continue;let yn=fn(w,V),Ee=et*yn,ie=Math.max(1,Math.floor((Gt-et)/Ee)+1),Mn=(ie-1)*Ee+et,at=(Gt-Mn)/et>.3?ie+1:ie,gt=at<=1?et:(Gt-et)/(at-1),we=Mt*Ct,Re=0;we>0&&(Re=Math.ceil(we/gt));let An=at+Re,it;if(J==="ltr")it="ltr";else if(J==="rtl")it="rtl";else if(J==="center")it="center";else if(J==="alternate")it=w%2===1!==rn?"rtl":"ltr";else if(J==="diagonal"){let P=(sn+(ln?w:-w)+_*100)%_;it=V<P?"ltr":"rtl"}else if(J==="randomMid"){let P=L(e+55555+w),Ot=Math.floor(P()*_);it=V<Ot?"ltr":"rtl"}else J==="checkerboard"?it=(w+V)%2===0?"ltr":"rtl":it="ltr";let Bt=rt+Gt/2;for(let P=0;P<An&&H>=0;P++){let Ot=q;H>=2&&P>0&&P%2===0&&(Ot=lt[Math.max(0,H-1)]);let nt;if(it==="center")if(P<at){let st=Math.floor((P+1)/2)*gt;P%2===0?nt=Bt+(P===0?-et/2:st-et/2):nt=Bt-st-et/2}else{let st=P-at,Xt=Math.floor(at/2)*gt,Yt=Math.floor((st+1)/2)*gt;if(st%2===0){if(nt=Bt+Xt+Yt,nt+et>le)break}else if(nt=Bt-Xt-Yt-et,nt<se)break}else if(P<at)nt=rt+P*gt;else if(it==="rtl"){let st=P-at;if(nt=rt-(st+1)*gt,nt<se)break}else{let st=P-at;if(nt=tt+st*gt,nt+et>le)break}if(oe&&!jt){let st=pn(w,V),Xt=i.globalAlpha,Yt=i.fillStyle;i.globalAlpha=dn,i.fillStyle=gn,i.fillText(Ot,nt+st.x,Z+st.y),i.globalAlpha=Xt,i.fillStyle=Yt}i.fillText(Ot,nt,Z)}jt&&(i.globalAlpha=1)}}}}if(C){i.strokeStyle=l,i.lineWidth=.5,i.globalAlpha=1;for(let m=0;m<k;m++)for(let M=0;M<_;M++){let w=Math.round(z+M*Tt),Z=Math.round($+m*It);i.strokeRect(w,Z,Ct,Dt)}}if(G&&Ft.length>0){let M=L(e+9292)()<.6;i.strokeStyle=M?l:o,i.lineWidth=1.5*F,i.globalAlpha=.85,i.lineCap="round";for(let w of Ft)i.beginPath(),i.moveTo(z+w.p1.x,$+w.p1.y),i.lineTo(z+w.p2.x,$+w.p2.y),i.stroke();i.globalAlpha=1}if(b){let m=R=>{let D=parseInt(R.slice(1,3),16),q=parseInt(R.slice(3,5),16),S=parseInt(R.slice(5,7),16);return Ce(D,q,S)},M=m(n),w=m(o),Z=m(l),V=Math.abs(M-w)>Math.abs(M-Z)?o:l,rt=2*F;i.strokeStyle=V,i.lineWidth=rt,i.globalAlpha=1,i.lineCap="round";for(let R of Ft)i.beginPath(),i.moveTo(z+R.p1.x,$+R.p1.y),i.lineTo(z+R.p2.x,$+R.p2.y),i.stroke()}if(a){let m=Je.map(M=>({x:M.x*F,y:M.y*T}));if(m.length>=3){i.strokeStyle="#00ffff",i.lineWidth=2,i.globalAlpha=.9,i.beginPath(),i.moveTo(z+m[0].x,$+m[0].y);for(let M=1;M<m.length;M++)i.lineTo(z+m[M].x,$+m[M].y);i.closePath(),i.stroke(),i.fillStyle="#00ffff",i.globalAlpha=.15,i.fill(),i.globalAlpha=1}}if(E){i.strokeStyle=o,i.lineWidth=1,i.globalAlpha=.3;for(let m=0;m<=_;m++){let M=z+m*Tt;i.beginPath(),i.moveTo(M,$),i.lineTo(M,$+qt),i.stroke()}for(let m=0;m<=k;m++){let M=$+m*It;i.beginPath(),i.moveTo(z,M),i.lineTo(z+ye,M),i.stroke()}i.globalAlpha=1}if(u){let m=8*F;if(i.lineWidth=2,i.globalAlpha=1,mt){let M=z+mt.x*F,w=$+mt.y*T;i.strokeStyle="#00ff00",i.beginPath(),i.arc(M,w,m,0,Math.PI*2),i.stroke()}if(xt){let M=z+xt.x*F,w=$+xt.y*T;i.strokeStyle="#00ff00",i.beginPath(),i.arc(M,w,m,0,Math.PI*2),i.stroke()}}let xn={grid:{cols:_,rows:k,colGap:K.colGap,rowGap:K.rowGap},drawDirection:J,foldStrategy:A?.type||"random",multiColor:p,showCreaseLines:G,creaseCount:Me.length};return{canvas:U,dataUrl:U.toDataURL("image/png"),settings:xn}}function xe(t,e=1200,r=1697,s=0,n=null){let o=Nn(t),l=Dn(e,r,s,t),h=kn(t),f=ge(t),g=We(t),p=Wn(t),x=p?Sn(t,o.bg,o.text):null,A=Se(t),d=jn(t),c=Pn(t),b=Hn(t),a=n;if(a===null){let u=L(t+9999);a=Math.floor(1+u()*500)}return{seed:t,palette:o,cells:l,renderMode:h,weightRange:f,foldStrategy:g,multiColor:p,levelColors:x,maxFolds:A,paperProperties:d,showCreaseLines:c,overlapInfo:b,folds:a}}function ro(t,e,r,s=""){let n=xe(e,1200,1697,0,r),o=ge(e),l=1200-145*2,h=1697-145*2,{creases:f}=je(l,h,r,e,o,n.foldStrategy,n.paperProperties),g=Bn(n.paperProperties);return{name:`Fold #${t}`,description:"On-chain generative paper folding art",image:s?`${s}/${t}`:"",attributes:[{trait_type:"Fold Strategy",value:n.foldStrategy.type},{trait_type:"Render Mode",value:n.renderMode},{trait_type:"Multi-Color",value:n.multiColor?"Yes":"No"},{trait_type:"Cell Size",value:`${n.cells.cellW}x${n.cells.cellH}`},{trait_type:"Fold Count",value:r},{trait_type:"Max Folds",value:n.maxFolds},{trait_type:"Crease Count",value:f.length},{trait_type:"Palette Strategy",value:n.palette.strategy},{trait_type:"Paper Type",value:g},{trait_type:"Paper Grain",value:n.paperProperties.angleAffinity!==null?"Grain":"Uniform"},...n.showCreaseLines?[{trait_type:"Crease Lines",value:"Visible"}]:[]]}}async function so(t){if(!t)return!1;let e=document.createElement("style");e.textContent=`
    @font-face {
      font-family: '${$t}';
      src: url('${t}');
    }
  `,document.head.appendChild(e);try{return await document.fonts.load(`12px ${$t}`),!0}catch(r){return console.warn("Failed to load on-chain font:",r),!1}}function lo(t){if(typeof t=="number")return t;if(typeof t!="string")return 0;let e=t.replace(/^0x/,"").slice(0,16),r=BigInt("0x"+e);return Number(r%BigInt(2147483647))}function io(){let t=window.devicePixelRatio||1,e=window.innerWidth||1200,r=window.innerHeight||1697,s=1/Math.sqrt(2),n,o;e/r>s?(o=r,n=Math.floor(o*s)):(n=e,o=Math.floor(n/s)),n=Math.max(n,100),o=Math.max(o,141);let l=Math.floor(n*t),h=Math.floor(o*t);return{width:n,height:o,renderWidth:l,renderHeight:h,dpr:t}}var Lt=null;var de=!1,ft=!1,Kt=0,ae=null,zt=null,Nt=null;function ao(t,e,r={}){let{onRender:s,getDimensions:n}=r;Nt&&Nt();function o(p,x,A){let d=e();if(!d)return;let c=n?n():{};Xe(t,d,{foldOverride:p,linesOnly:x,isAnimating:A,width:c.width,height:c.height}),s&&s()}function l(){let p=e();if(!ft||!p||Kt>p.foldCount){f();return}o(Kt,ae==="lines-only",!0),Kt++,zt=setTimeout(l,50)}function h(p){ft=!0,Kt=0,ae=p,l()}function f(){ft=!1,ae=null,zt&&(clearTimeout(zt),zt=null)}function g(p){e()&&(p.shiftKey&&p.key==="F"&&(p.preventDefault(),de=!de,ft||o()),p.shiftKey&&p.key==="A"&&(p.preventDefault(),ft&&f(),h("full")),p.shiftKey&&p.key==="L"&&(p.preventDefault(),ft&&f(),h("lines-only")),p.key==="Escape"&&ft&&(p.preventDefault(),f()))}return document.addEventListener("keydown",g),Nt=()=>{document.removeEventListener("keydown",g),f(),Nt=null},Nt}function Xe(t,e,r={}){let{foldOverride:s,linesOnly:n=!1,isAnimating:o=!1,width:l,height:h,showOverlays:f}=r,g=l&&h?{renderWidth:l,renderHeight:h,width:l,height:h}:io(),p=s!==void 0?s:e.foldCount,x=f!==void 0?f:o?n:n||de,{canvas:A,dataUrl:d,settings:c}=Be({folds:p,seed:e.seed,outputWidth:g.renderWidth,outputHeight:g.renderHeight,bgColor:e.params.palette.bg,textColor:e.params.palette.text,accentColor:e.params.palette.accent,cellWidth:e.params.cells.cellW,cellHeight:e.params.cells.cellH,renderMode:e.params.renderMode,multiColor:e.params.multiColor,levelColors:e.params.levelColors,foldStrategy:e.params.foldStrategy,paperProperties:e.params.paperProperties,showCreaseLines:e.params.showCreaseLines,showCreases:x,showIntersections:x,linesOnlyMode:n}),b=t.getContext("2d");return t.width=A.width,t.height=A.height,t.style.width=g.width+"px",t.style.height=g.height+"px",b.drawImage(A,0,0),typeof window<"u"&&typeof window.scaleCanvas=="function"&&window.scaleCanvas(),{dataUrl:d,settings:c}}function Ne(t,e,r,s,n){return Xe(t,e,{foldOverride:r,linesOnly:s,isAnimating:n})}function co(t,e){let r;return function(...s){clearTimeout(r),r=setTimeout(()=>t.apply(this,s),e)}}async function pe(){let t=typeof window<"u"&&window.SEED,e=typeof window<"u"&&window.FOLD_COUNT,r=typeof window<"u"&&window.LESS_SEED;if(r&&!t&&(t=lo(r)),t&&e===void 0){let n=L(t+9999);e=Math.floor(1+n()*500)}let s=typeof window<"u"&&window.FONT_DATA_URI||De;if(t&&e!==void 0){let n=document.getElementById("c")||document.querySelector("canvas");n||(n=document.createElement("canvas"),n.id="c",document.body.appendChild(n),document.body.style.cssText="margin:0;padding:0;background:#000;display:flex;align-items:center;justify-content:center;min-height:100vh;overflow:hidden;"),await so(s);let o=xe(t,1200,1697,0,e);Lt={seed:t,foldCount:e,params:o},Ne(n,Lt),window.addEventListener("resize",co(()=>{Lt&&!ft&&Ne(n,Lt)},150)),ao(n,()=>Lt)}}typeof window<"u"&&(window.SEED||window.FOLD_COUNT!==void 0||window.LESS_SEED)&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>pe()):pe());})();
