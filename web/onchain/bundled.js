(()=>{var Jt="FoldMono",Xe="data:font/woff2;charset=utf-8;base64,d09GMgABAAAAAAOIAA4AAAAADAQAAAM2AAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGhYbEBwmBmAAPBEQCo9sjiABNgIkAwwLDAAEIAWCfAcgGzkKIK4GbGOy2GicLj5u8RpRKYyZuIy26Oe9GkG0llXPQhAUoVLRQOiIjYYnUuLluRfqlUh8nv35d3DbeacPRpI7wLzuWl2XGTr+R4rdqk48ecPEg8A0wvynUz9VJ0gGYLd1C/5xl7xv3SZnBWzBGr8QtP8P9KU3gF/4v///XtV/LeBjv+MBmzYJYqG96Ce0h6/5XmbHBNnLAlygYMFqXKAK1bYRcgkLxgZhXaf627YE6gFJIBcCteo1AuwbDBChbA4tEHHa8CDi2utCBABSXokNorp4phkhurc/Cdkmqp0bWqrKalIqUp4jaAbAzD4U5MOrPfX1JpR/yDVAQLZF3YE+VCRkaEcRaEc1Bkq5kJLE/gHUNnm3+zdMKK9aMhR+h189BajFT9I/lJ0BIAcwLMQ2l3Yj73wvYnyWbjmo3XbjJ0eY8W5h/BrjMzLJ2VlnUo3PYuKqtuQN3OLm3X+/upK1DTdwjZsDyUyqec6GEF09syI3F92yUZdMJ62DE7XK6uCueMYse9occDNSOJk2TzuvAA1ohsS27Vw8Tqt1nSmHabjbFnGndFO5K3PzpJ4CUz1JBorMmHHLdmQwBHRTnMkKhQ2QvVOwlGW8DcP5FqbrJJvdjsuaDB97D7UPuQfMWVxWiURGZPMptIkVhKEJKCNQDIyTFKlyZLbV+p53gX4egWr7bX73rYYTy+fRt6NAzImHc31/acg9fC0EFH1/obMyd7VtOx4JfU3acYK4OL1wfhzUFbtqf+2dJ+YG3K/voIAkorej7to5G4ZgZG5J17dlDgasZyO9xT2bOM2geuh5N335H/05CBAo+D8a3teHrs9kVYNvlTICfznXj/qG+mEqQY0AQfnnlyCvvGfUD0jWq5FXOCj0rhgQshT513IJVZZQRF6DIzii0KmJkkZPKLNkNZ7LUKHHe3ulrkb3x2Kgo2PDk1VXwRPT09UzttAnIRgd6m8KBWMNkbgGj19b25mmG2vqxkaEs7LdVDE0VVGmSeKcTHfjguaJm3smpWsmdnzBsDSJIzDqMKW8o1bEecw0dHS0TGzyS4Z6n9NTNSaXDzlPw2BeyPLakJQRk0Wx9HurZUEAAA==",An='"Courier New", Courier, monospace',Ye=`"${Jt}", ${An}`,je=.6,de=.08,pe=.06,wn=.03,En=.05;function Cn(t,e,o){let s=t/255,n=e/255,r=o/255;return(.2126*s+.7152*n+.0722*r)*100}var V=[{hex:"#000000",name:"black",luminance:0,temperature:"neutral",r:0,g:0,b:0},{hex:"#0000AA",name:"blue",luminance:10,temperature:"cool",r:0,g:0,b:170},{hex:"#AA0000",name:"red",luminance:20,temperature:"warm",r:170,g:0,b:0},{hex:"#AA00AA",name:"magenta",luminance:25,temperature:"warm",r:170,g:0,b:170},{hex:"#FFFFFF",name:"white",luminance:100,temperature:"neutral",r:255,g:255,b:255},{hex:"#FFFF55",name:"yellow",luminance:93,temperature:"warm",r:255,g:255,b:85},{hex:"#55FFFF",name:"lightCyan",luminance:85,temperature:"cool",r:85,g:255,b:255},{hex:"#55FF55",name:"lightGreen",luminance:77,temperature:"cool",r:85,g:255,b:85},{hex:"#00AA00",name:"green",luminance:30,temperature:"cool",r:0,g:170,b:0},{hex:"#00AAAA",name:"cyan",luminance:40,temperature:"cool",r:0,g:170,b:170},{hex:"#5555FF",name:"lightBlue",luminance:45,temperature:"cool",r:85,g:85,b:255},{hex:"#FF5555",name:"lightRed",luminance:45,temperature:"warm",r:255,g:85,b:85},{hex:"#FF55FF",name:"lightMagenta",luminance:60,temperature:"warm",r:255,g:85,b:255}],Rn=V.filter(t=>t.luminance<30||t.luminance>70),Tn={black:.2,white:.15,blue:.15,red:.15,magenta:.1,yellow:.1,lightCyan:.08,lightGreen:.07},Rt=V,In=V.filter(t=>t.temperature!=="neutral"),Fn=V.filter(t=>t.temperature!=="neutral"),_e=V,bo={dark:V.filter(t=>t.luminance<30),light:V.filter(t=>t.luminance>70)},Le={warm:V.filter(t=>t.temperature==="warm"),cool:V.filter(t=>t.temperature==="cool"),neutral:V.filter(t=>t.temperature==="neutral")};function On(t,e,o){let s=t.luminance,n=e.luminance,r=[];for(let i=0;i<o;i++){let p=i/(o-1),u=s+(n-s)*p,h=V.filter(M=>M.temperature===t.temperature||M.temperature==="neutral"),A=h[0],w=Math.abs(A.luminance-u);for(let M of h){let m=Math.abs(M.luminance-u);m<w&&(w=m,A=M)}r.push(A)}return r}function Se(t,e,o=4.5){let s=t.luminance/100,n=e.luminance/100,r=Math.max(s,n)+.05,i=Math.min(s,n)+.05;return r/i>=o}function Qt(t,e){return e[Math.floor(t()*e.length)]}function Gn(t,e,o){let s=t(),n=0;for(let r of e)if(n+=o[r.name]||0,s<n)return r;return e[e.length-1]}function Kt(t,e,o){e/=100,o/=100;let s=e*Math.min(o,1-o),n=r=>{let i=(r+t/30)%12,p=o-s*Math.max(Math.min(i-3,9-i,1),-1);return Math.round(255*p).toString(16).padStart(2,"0")};return`#${n(0)}${n(8)}${n(4)}`}function St(t){let e=parseInt(t.slice(1,3),16)/255,o=parseInt(t.slice(3,5),16)/255,s=parseInt(t.slice(5,7),16)/255,n=Math.max(e,o,s),r=Math.min(e,o,s),i,p,u=(n+r)/2;if(n===r)i=p=0;else{let h=n-r;switch(p=u>.5?h/(2-n-r):h/(n+r),n){case e:i=((o-s)/h+(o<s?6:0))/6;break;case o:i=((s-e)/h+2)/6;break;case s:i=((e-o)/h+4)/6;break}}return{h:i*360,s:p*100,l:u*100}}var vn={red:["cyan","lightCyan"],magenta:["green","lightGreen"],blue:["yellow"],lightRed:["cyan","lightCyan"],lightMagenta:["green","lightGreen"],lightBlue:["yellow"],cyan:["red","lightRed"],lightCyan:["red","lightRed"],green:["magenta","lightMagenta"],lightGreen:["magenta","lightMagenta"],yellow:["blue","lightBlue"],black:["white","yellow","lightCyan"],white:["black","blue","magenta"]};function _n(t,e,o){let n=[];switch(e){case"value":{let r=t.luminance<50;n=Rt.filter(i=>r?i.luminance>60:i.luminance<40);break}case"temperature":{if(t.temperature==="neutral")n=Rt.filter(r=>r.temperature!=="neutral"&&Math.abs(r.luminance-t.luminance)>25);else{let r=t.temperature==="warm"?"cool":"warm";n=Rt.filter(i=>i.temperature===r&&Math.abs(i.luminance-t.luminance)>25)}break}case"complement":{let r=vn[t.name]||[];if(n=Rt.filter(i=>r.includes(i.name)),n.length===0){let i=t.luminance<50;n=Rt.filter(p=>i?p.luminance>60:p.luminance<40)}break}case"clash":{n=Rt.filter(r=>r.name!==t.name&&Math.abs(r.luminance-t.luminance)>20&&Math.abs(r.luminance-t.luminance)<50);break}}return n.sort((r,i)=>Math.abs(i.luminance-t.luminance)-Math.abs(r.luminance-t.luminance)),n.length>0?Qt(o,n):t.luminance<50?V.find(r=>r.name==="white"):V.find(r=>r.name==="black")}function Ln(t,e,o){if(o()<.4)return e;let s=In.filter(r=>r.name!==t.name&&r.name!==e.name&&Math.abs(r.luminance-t.luminance)>20);if(s.length===0)return e;let n=s.filter(r=>["yellow","lightCyan","lightMagenta","lightGreen"].includes(r.name));return n.length>0&&o()<.6?Qt(o,n):Qt(o,s)}function Sn(t){let e=Qt(t,Fn),o;return e.luminance>50?o=V.find(s=>s.name==="black"):e.luminance<30?o=t()<.75?V.find(s=>s.name==="black"):V.find(s=>s.name==="white"):o=t()<.6?V.find(s=>s.name==="black"):V.find(s=>s.name==="white"),{bg:o.hex,text:e.hex,accent:e.hex,strategy:`monochrome/${e.name}`,colorCount:2}}function Dn(t){let e=N(t);if(e()<.12)return Sn(e);let o=Gn(e,Rn,Tn),s=e(),n;s<.4?n="value":s<.68?n="temperature":s<.9?n="complement":n="clash";let r=_n(o,n,e),i=Ln(o,r,e),p=i.hex===r.hex?2:3;return Math.abs(o.luminance-r.luminance)<25?{bg:o.luminance<50?"#000000":"#FFFFFF",text:o.luminance<50?"#FFFFFF":"#000000",accent:"#FFFF55",strategy:n,colorCount:p}:{bg:o.hex,text:r.hex,accent:i.hex,strategy:n,colorCount:p}}function De(t,e,o){let s=[];for(let n=e;n<=o;n++)t%n===0&&s.push(n);return s}function Nn(t,e,o,s){let n=1200-o*2-290,r=1697-o*2-145*2,i=De(n,20,600),p=De(r,20,600);i.length===0&&i.push(8),p.length===0&&p.push(12);let u=N(s+9999),h=1+de+pe,A=je/h,w=[];for(let c of i)for(let x of p){let a=Math.max(c/x,x/c),f=x*A;a<=3&&c>=f&&w.push({w:c,h:x})}if(w.length===0)return{cellW:8,cellH:12};w.sort((c,x)=>c.w*c.h-x.w*x.h);let M=u(),m;if(M<.03){let c=Math.max(1,Math.ceil(w.length*.1)),x=Math.floor(u()*c);m=w[x]}else if(M<.1){let c=Math.floor(w.length*.1),x=Math.floor(w.length*.25),a=c+Math.floor(u()*Math.max(1,x-c));m=w[Math.min(a,w.length-1)]}else if(M<.45){let c=Math.floor(w.length*.25),x=Math.floor(w.length*.75),a=c+Math.floor(u()*(x-c));m=w[Math.min(a,w.length-1)]}else if(M<.95){let c=Math.floor(w.length*.75),x=Math.floor(w.length*.9),a=c+Math.floor(u()*Math.max(1,x-c));m=w[Math.min(a,w.length-1)]}else{let c=Math.floor(w.length*.9),x=c+Math.floor(u()*(w.length-c));m=w[Math.min(x,w.length-1)]}return{cellW:m.w,cellH:m.h}}function kn(t){let o=N(t+5555)();return o<.35?"normal":o<.4?"binary":o<.65?"inverted":o<.825?"sparse":"dense"}function Me(t){let e=N(t+7777),o=e();if(o<.25){let s=.2+e()*.2;return{min:s,max:s+.1+e()*.2}}else if(o<.5){let s=.6+e()*.2;return{min:s,max:s+.1+e()*.1}}else return o<.75?{min:.1+e()*.2,max:.7+e()*.3}:{min:.3+e()*.2,max:.5+e()*.5}}function Hn(t){let e=N(t+11111);if(!(e()>=.5))return{hasOverlap:!1,amount:"none"};let s=e(),n;return s<.2?n="5%":s<.4?n="25%":s<.6?n="50%":s<.8?n="75%":n="95%",{hasOverlap:!0,amount:n}}function Be(t){let e=N(t+2222);return Math.floor(4+e()*66)}function $e(t){let e=N(t+6666),o=e();return o<.16?{type:"horizontal",jitter:3+e()*12}:o<.32?{type:"vertical",jitter:3+e()*12}:o<.44?{type:"diagonal",angle:e()<.5?45:135,jitter:5+e()*15}:o<.56?{type:"radial",focalX:.2+e()*.6,focalY:.2+e()*.6}:o<.68?{type:"grid",jitter:3+e()*10}:o<.8?{type:"clustered",clusterX:.15+e()*.7,clusterY:.15+e()*.7,spread:.2+e()*.4}:{type:"random"}}function Ne(t){let e=t.toUpperCase();return _e.find(o=>o.hex===e)||_e[0]}function Wn(t,e,o){let s=N(t+3333),n=Ne(e),r=Ne(o),i=n.luminance>50,p=(h,A)=>i?A.luminance-h.luminance:h.luminance-A.luminance;if(s()<.5){let h=On(n,r,6);return[h[0].hex,h[Math.floor(h.length*.33)].hex,h[Math.floor(h.length*.66)].hex,h[h.length-1].hex]}else{let h=r.temperature,A=h==="warm"?"cool":"warm",w=Le[h].filter(g=>Se(n,g,2)).sort(p),M=Le[A].filter(g=>Se(n,g,2)).sort(p),m=[],c=new Set;w.length>0?(m.push(w[0].hex),c.add(w[0].hex)):(m.push(r.hex),c.add(r.hex));let x=w.filter(g=>!c.has(g.hex));if(x.length>0){let g=x[Math.floor(x.length*.4)];m.push(g.hex),c.add(g.hex)}else m.push(r.hex);let a=M.filter(g=>!c.has(g.hex));if(a.length>0){let g=a[Math.floor(a.length*.5)];m.push(g.hex),c.add(g.hex)}else m.push(r.hex);let f=[...w,...M].filter(g=>!c.has(g.hex)).sort(p);return f.length>0?m.push(f[f.length-1].hex):m.push(r.hex),m}}function Pn(t){return N(t+4444)()<.25}function Xn(t){return N(t+9191)()<.008}function Yn(t){let e=N(t+5555),o=.1+e()*.8,s=0,n=e()<.4,r=n?e()*180:null,i=n?.2+e()*.6:0,p=.3+e()*1.4;return{absorbency:o,intersectionThreshold:s,angleAffinity:r,affinityStrength:i,ceilingMultiplier:p}}function jn(t){let e=t.absorbency<.35?"Resistant":t.absorbency<.65?"Standard":"Absorbent",o=t.intersectionThreshold<.15?"Fine":t.intersectionThreshold<.35?"Medium":"Coarse",s=t.angleAffinity!==null?"Grain":"Uniform";return`${e}/${o}/${s}`}function Bn(t,e,o){return t}var ke=[-1/1,-1/2,-1/4,-1/8,-1/16,1/64,1/32,1/16,1/8,1/4,1/2,1,2];function $n(t,e,o,s,n,r=null){let i=N(t+12345);if(r){let{colGapRatio:_=0,rowGapRatio:W=0}=r,L=e*_,P=o*W,G=e+L,T=o+P,v=G>0?Math.max(1,Math.floor((s+L)/G)):1,nt=T>0?Math.max(1,Math.floor((n+P)/T)):1,Dt=v*e+(v-1)*L,Nt=nt*o+(nt-1)*P,Zt=(s-Dt)/2,te=(n-Nt)/2;return{cols:v,rows:nt,cellWidth:e,cellHeight:o,colGap:L,rowGap:P,strideX:G,strideY:T,gridOffsetX:Math.max(0,Zt),gridOffsetY:Math.max(0,te),actualGridWidth:Dt,actualGridHeight:Nt}}let p=i()<.4,u=!1,h=!1,A=!1,w=!1;if(p){let _=i();_<.33?u=!0:(_<.66||(u=!0),h=!0),u&&i()<.3&&(A=!0),h&&i()<.3&&(w=!0)}let M=[-1/16,-1/8,-1/4,-1/2],m=_=>{if(_)return M;let W=ke.slice(5,12);return i()<.25&&W.push(ke[12]),W},c=e,x=o,a=1,f=0,g=1/0;if(A){let _=M[Math.floor(i()*M.length)],W=c*_,L=c+W;L>0&&(a=Math.max(1,Math.floor((s+W)/L)),f=W)}else{let _=u?m(!1):[0];for(let W of _){let L=c*W,P=c+L;if(P<=0)continue;let G=Math.max(1,Math.floor((s+L)/P));if(G===1){let T=Math.min(c,s),v=Math.abs(s-T);v<g&&(g=v,a=1,f=0,c=T)}else{let T=G*c+(G-1)*L;if(T<=s){let v=Math.abs(s-T);v<g&&(g=v,a=G,f=L)}}}a===1&&c<s&&(c=s,f=0)}let b=1,R=0,C=1/0;if(w){let _=M[Math.floor(i()*M.length)],W=x*_,L=x+W;L>0&&(b=Math.max(1,Math.floor((n+W)/L)),R=W)}else{let _=h?m(!1):[0];for(let W of _){let L=x*W,P=x+L;if(P<=0)continue;let G=Math.max(1,Math.floor((n+L)/P));if(G===1){let T=Math.min(x,n),v=Math.abs(n-T);v<C&&(C=v,b=1,R=0,x=T)}else{let T=G*x+(G-1)*L;if(T<=n){let v=Math.abs(n-T);v<C&&(C=v,b=G,R=L)}}}}b===1&&x<n&&(x=n,R=0);let F=a,I=b,D=f,Q=R,B=F*c+(F>1?(F-1)*D:0),l=I*x+(I>1?(I-1)*Q:0),H=s-B,O=n-l;return{cols:F,rows:I,cellWidth:c,cellHeight:x,colGap:D,rowGap:Q,strideX:c+D,strideY:x+Q,gridOffsetX:H>0?H/2:0,gridOffsetY:O>0?O/2:0,actualGridWidth:B,actualGridHeight:l}}function Un(t){let e=Object.values(t).filter(p=>p>0);if(e.length===0)return{t1:1,t2:2,t3:3,tExtreme:999};e.sort((p,u)=>p-u);let o=(p,u)=>{let h=Math.floor(p.length*u);return p[Math.min(h,p.length-1)]},s=o(e,.7),n=o(e,.94),r=o(e,.94)+1,i=o(e,.985);return{t1:Math.max(.01,s),t2:Math.max(s+.01,n),t3:Math.max(n+.01,r),tExtreme:Math.max(r+.01,i)}}function Tt(t,e){return t===0?0:t<=e.t1?1:t<=e.t2?2:3}var Kn=1103515245n,zn=12345n,He=0x7fffffffn;function N(t){let e=BigInt(Math.abs(t)||1);return()=>(e=e*Kn+zn&He,Number(e)/Number(He))}var j={add:(t,e)=>({x:t.x+e.x,y:t.y+e.y}),sub:(t,e)=>({x:t.x-e.x,y:t.y-e.y}),scale:(t,e)=>({x:t.x*e,y:t.y*e}),dot:(t,e)=>t.x*e.x+t.y*e.y,len:t=>Math.sqrt(t.x*t.x+t.y*t.y),dist:(t,e)=>j.len(j.sub(t,e)),norm:t=>{let e=j.len(t);return e>1e-4?j.scale(t,1/e):{x:0,y:0}},perp:t=>({x:-t.y,y:t.x}),mid:(t,e)=>({x:(t.x+e.x)/2,y:(t.y+e.y)/2}),lerp:(t,e,o)=>({x:t.x+(e.x-t.x)*o,y:t.y+(e.y-t.y)*o}),copy:t=>({x:t.x,y:t.y}),eq:(t,e)=>j.dist(t,e)<.5};function be(t,e,o,s){let n=j.sub(e,t),r=j.sub(s,o),i=n.x*r.y-n.y*r.x;if(Math.abs(i)<1e-4)return null;let p=j.sub(o,t),u=(p.x*r.y-p.y*r.x)/i,h=(p.x*n.y-p.y*n.x)/i;return u>=.001&&u<=.999&&h>=.001&&h<=.999?{point:j.add(t,j.scale(n,u)),t:u,u:h}:null}function We(t,e){let o=t.reduce((n,r)=>n+r,0);if(o<=0)return 0;let s=e()*o;for(let n=0;n<t.length;n++)if(s-=t[n],s<=0)return n;return t.length-1}var Vn=0,qn=1,Jn=2,Qn=3;function rt(t,e,o,s){switch(t){case Vn:return{x:e*o,y:0};case qn:return{x:o,y:e*s};case Jn:return{x:(1-e)*o,y:s};case Qn:return{x:0,y:(1-e)*s};default:return{x:e*o,y:0}}}function ge(t,e,o){switch(t){case 0:return{x:0,y:0};case 1:return{x:e,y:0};case 2:return{x:e,y:o};case 3:return{x:0,y:o};default:return{x:0,y:0}}}function Ue(t,e){return{x:t.p1.x+(t.p2.x-t.p1.x)*e,y:t.p1.y+(t.p2.y-t.p1.y)*e}}function me(t,e){let o=e.x-t.x,s=e.y-t.y,n=Math.atan2(s,o)*180/Math.PI;return n<0&&(n+=180),n>=180&&(n-=180),n}function Zn(t,e,o,s,n,r,i){let u=(()=>{if(!i)return[0,1,2,3];switch(i.type){case"horizontal":return[1,3];case"vertical":return[0,2];case"grid":return t%2===0?[1,3]:[0,2];case"diagonal":return[0,1,2,3];case"radial":case"clustered":case"random":default:return[0,1,2,3]}})();if(i&&i.type==="radial"){let M=i.focalX*s,m=i.focalY*n;if(t<10||e.length===0||r()<.6){let c=[{edge:0,dist:m},{edge:1,dist:s-M},{edge:2,dist:n-m},{edge:3,dist:M}];c.sort((g,b)=>g.dist-b.dist);let x=r(),a=x<.5?c[0].edge:x<.8?c[1].edge:c[Math.floor(r()*4)].edge,f;return a===0||a===2?f=.1+M/s*.8+(r()-.5)*.3:f=.1+m/n*.8+(r()-.5)*.3,f=Math.max(.05,Math.min(.95,f)),{point:rt(a,f,s,n),type:"edge",edge:a,t:f}}}if(i&&i.type==="clustered"){let M=i.clusterX*s,m=i.clusterY*n,c=i.spread;if(t<15||r()<.7){let x=[{edge:0,weight:1+(1-Math.abs(m/n))*2},{edge:1,weight:1+M/s*2},{edge:2,weight:1+m/n*2},{edge:3,weight:1+(1-M/s)*2}],a=x.reduce((R,C)=>R+C.weight,0),f=r()*a,g=0;for(let R of x)if(f-=R.weight,f<=0){g=R.edge;break}let b;return g===0||g===2?b=M/s+(r()-.5)*c:b=m/n+(r()-.5)*c,b=Math.max(.05,Math.min(.95,b)),{point:rt(g,b,s,n),type:"edge",edge:g,t:b}}}let h=Math.max(.2,1-t*.015),A=i&&(i.type==="horizontal"||i.type==="vertical"||i.type==="grid");if(A||r()<h||e.length===0&&o.length===0){let M=A?0:i&&i.type==="diagonal"?.5:.15;if(r()<M){let c=Math.floor(r()*4);return{point:ge(c,s,n),type:"corner",corner:c}}else{let c=u[Math.floor(r()*u.length)],x=i&&i.jitter?i.jitter/100:0,a=.05+r()*.9,f=Math.max(.05,Math.min(.95,a+(r()-.5)*x));return{point:rt(c,f,s,n),type:"edge",edge:c,t:f}}}else if(o.length>0&&r()<.35){let m=o[Math.floor(r()*o.length)];return{point:{x:m.x,y:m.y},type:"intersection",intersectionIndex:o.indexOf(m)}}else if(e.length>0){let m=e[Math.floor(r()*e.length)],c=.1+r()*.8;return{point:Ue(m,c),type:"crease",creaseIndex:e.indexOf(m),t:c}}else{let m=u[Math.floor(r()*u.length)],c=.05+r()*.9;return{point:rt(m,c,s,n),type:"edge",edge:m,t:c}}}function to(t,e,o,s,n,r,i,p,u){let h=Math.min(n,r)*.15,A=a=>a===0||a===2,w=a=>a===1||a===3;if(u&&(u.type==="horizontal"||u.type==="vertical"||u.type==="grid")){let a=u.type==="horizontal"||u.type==="grid"&&e%2===0;if(t.type==="edge"){let f=(t.edge+2)%4,g=w(t.edge);if(a&&g||!a&&!g){let b=u.jitter?u.jitter/100:0,R=t.t!==void 0?t.t:.5,C=Math.max(.05,Math.min(.95,R+(i()-.5)*b));return C=1-C,{point:rt(f,C,n,r),type:"edge",edge:f}}}}if(u&&u.type==="diagonal"){let a=u.angle||(i()<.5?45:135);if(t.type==="corner"){let f=(t.corner+2)%4;return{point:ge(f,n,r),type:"corner"}}else if(t.type==="edge"){let f=u.jitter?(i()-.5)*u.jitter:0,g=(a+f)*Math.PI/180,b=t.point.x,R=t.point.y,C=Math.cos(g),F=Math.sin(g),I=null,D=0,Q=[{edge:0,y:0},{edge:2,y:r},{edge:3,x:0},{edge:1,x:n}];for(let B of Q){let l=null;if(B.y!==void 0){let H=(B.y-R)/F;if(H>0){let O=b+C*H;O>=0&&O<=n&&(l={x:O,y:B.y})}}else{let H=(B.x-b)/C;if(H>0){let O=R+F*H;O>=0&&O<=r&&(l={x:B.x,y:O})}}if(l){let H=j.dist(t.point,l);H>D&&H>=h&&(D=H,I=l)}}if(I)return{point:I,type:"edge"}}}if(u&&u.type==="radial"){let a=u.focalX*n,f=u.focalY*r,g={x:a,y:f},b=t.point.x-a,R=t.point.y-f,C=Math.sqrt(b*b+R*R);if(C>0){let F=b/C,I=R/C,D=1/0;F>0&&(D=Math.min(D,(n-t.point.x)/F)),F<0&&(D=Math.min(D,-t.point.x/F)),I>0&&(D=Math.min(D,(r-t.point.y)/I)),I<0&&(D=Math.min(D,-t.point.y/I));let Q={x:Math.max(0,Math.min(n,t.point.x+F*D*.95)),y:Math.max(0,Math.min(r,t.point.y+I*D*.95))};if(j.dist(t.point,Q)>=h)return{point:Q,type:"edge"}}}if(u&&u.type==="clustered"){let a=u.clusterX*n,f=u.clusterY*r,g={x:a,y:f},b=[];for(let C=0;C<4;C++)for(let F=0;F<3;F++){let I=.1+i()*.8,D=rt(C,I,n,r),Q=eo(g,t.point,D),B=Math.max(n,r)*.5,l=Math.max(.1,1-Q/B)*3;b.push({point:D,type:"edge",edge:C,weight:l})}let R=b.filter(C=>j.dist(t.point,C.point)>=h);if(R.length>0){let C=R.map(I=>I.weight),F=We(C,i);return R[F]}}let M=[];if(t.type==="edge"){let a=(t.edge+2)%4,f=(t.edge+1)%4,g=(t.edge+3)%4,b=e<3?3:1.5;for(let C=0;C<3;C++){let F=.1+i()*.8;M.push({point:rt(a,F,n,r),type:"edge",edge:a,weight:b})}let R=1;for(let C=0;C<2;C++){let F=.1+i()*.8;M.push({point:rt(f,F,n,r),type:"edge",edge:f,weight:R}),M.push({point:rt(g,F,n,r),type:"edge",edge:g,weight:R})}}else if(t.type==="corner"){let a=(t.corner+2)%4;M.push({point:ge(a,n,r),type:"corner",weight:2});for(let f=0;f<4;f++)if(!(f===t.corner||f===(t.corner+3)%4)){let b=.2+i()*.6;M.push({point:rt(f,b,n,r),type:"edge",edge:f,weight:1.5})}}else{for(let a=0;a<4;a++){let f=.1+i()*.8;M.push({point:rt(a,f,n,r),type:"edge",edge:a,weight:1})}if(o.length>1&&e>3)for(let a=0;a<Math.min(3,o.length);a++){let f=Math.floor(i()*o.length),g=o[f];if(t.type==="crease"&&t.creaseIndex===f)continue;let b=.15+i()*.7;M.push({point:Ue(g,b),type:"crease",creaseIndex:f,weight:.6})}}if(o.length>0&&p)for(let a of M){let f=me(t.point,a.point);for(let g of o){let b=me(g.p1,g.p2),R=Math.abs(f-b);R>90&&(R=180-R),p.parallel>0&&R<15&&(a.weight*=1+p.parallel),p.perpendicular>0&&R>75&&(a.weight*=1+p.perpendicular)}}let m=M.filter(a=>j.dist(t.point,a.point)>=h);if(m.length===0){for(let f=0;f<4;f++){let b=rt(f,.5,n,r);if(j.dist(t.point,b)>=h)return{point:b,type:"edge",edge:f}}let a=t.type==="edge"?(t.edge+2)%4:0;return{point:rt(a,.5,n,r),type:"edge",edge:a}}let c=m.map(a=>a.weight),x=We(c,i);return m[x]}function eo(t,e,o){let s=o.x-e.x,n=o.y-e.y,r=s*s+n*n;if(r===0)return j.dist(t,e);let i=((t.x-e.x)*s+(t.y-e.y)*n)/r;i=Math.max(0,Math.min(1,i));let p={x:e.x+i*s,y:e.y+i*n};return j.dist(t,p)}function no(t){let e=[];for(let o=0;o<t.length;o++)for(let s=o+1;s<t.length;s++){let n=be(t[o].p1,t[o].p2,t[s].p1,t[s].p2);n&&e.push({x:n.point.x,y:n.point.y,crease1:o,crease2:s})}return e}function Ke(t,e,o,s,n={min:0,max:1},r=null,i=null){if(!t||!e||t<=0||e<=0)return{creases:[],finalShape:[]};let p=r||$e(s),u=Be(s),h=[{x:0,y:0},{x:t,y:0},{x:t,y:e},{x:0,y:e}],A=[],w=null,M=null;if(!o||o<=0)return{creases:[],finalShape:h,maxFolds:u,firstFoldTarget:null,lastFoldTarget:null};let m=N(s),c=N(s+8888),x=N(s+6666),a=i||{absorbency:1,intersectionThreshold:0,angleAffinity:null,affinityStrength:0,ceilingMultiplier:1},f=[],g=N(s+1111);for(let I=0;I<u;I++)f[I]=.001+g()*.25;let b=N(s+2222),R={parallel:b()*.8,perpendicular:b()*.8},C=Math.max(t,e)*.05,F=[];for(let I=0;I<o;I++){let D=I%u,Q=Math.floor(I/u);if(D===0&&Q>0)for(let T of A)T.reductionMultiplier!==void 0&&(T.weight=Math.max(.01,T.weight*T.reductionMultiplier));I%5===0&&A.length>1&&(F=no(A));let B=Zn(I,A,F,t,e,m,p),l=to(B,I,A,F,t,e,m,R,p),H=B.point,O=l.point,W=x()<a.absorbency,L=n.min+c()*(n.max-n.min);if(a.angleAffinity!==null&&a.affinityStrength>0){let T=me(H,O),v=Math.abs(T-a.angleAffinity);v>90&&(v=180-v);let nt=1-v/90*a.affinityStrength;L*=nt}if(W&&L>.01&&(A.push({p1:j.copy(H),p2:j.copy(O),depth:A.length,weight:L,cyclePosition:D,reductionMultiplier:f[D],anchorType:B.type,terminusType:l.type}),A.length>1)){let T=A[A.length-1];for(let v=0;v<A.length-1;v++){let nt=be(T.p1,T.p2,A[v].p1,A[v].p2);nt&&F.push({x:nt.point.x,y:nt.point.y,crease1:v,crease2:A.length-1})}}let P=j.mid(H,O),G={x:Math.max(C,Math.min(t-C,P.x)),y:Math.max(C,Math.min(e-C,P.y))};I===0&&w===null&&(w=G),M=G}return{creases:A,finalShape:h,maxFolds:u,firstFoldTarget:w,lastFoldTarget:M}}function oo(t){let e=[];for(let o=0;o<t.length;o++)for(let s=o+1;s<t.length;s++){let n=be(t[o].p1,t[o].p2,t[s].p1,t[s].p2);if(n){let r=t[o].weight||1,i=t[s].weight||1;e.push({x:n.point.x,y:n.point.y,depth1:t[o].depth,depth2:t[s].depth,gap:Math.abs(t[s].depth-t[o].depth),weight:r+i})}}return e}function ro(t,e,o,s,n,r=null,i=null){let p=oo(t),u=i||{intersectionThreshold:0,ceilingMultiplier:1},h=p.filter(a=>a.weight>=u.intersectionThreshold),A={},w={},M={};for(let a of h){let f=Math.floor(a.x/s),g=Math.floor(a.y/n);if(f>=0&&f<e&&g>=0&&g<o){let b=`${f},${g}`;A[b]=(A[b]||0)+a.weight,w[b]=Math.max(w[b]||0,a.gap),M[b]=(M[b]||0)+1}}let c=e*o*.5*u.ceilingMultiplier,x=Object.values(A).reduce((a,f)=>a+f,0);if(x>c&&x>0){let a=c/x,f=a+(1-a)*.3;for(let g of Object.keys(A))A[g]*=f}return{activeCreases:t,intersections:h,cellWeights:A,cellMaxGap:w,cellIntersectionCounts:M,destroyed:0,maxFolds:r}}function ze({folds:t,seed:e,outputWidth:o,outputHeight:s,bgColor:n,textColor:r,accentColor:i,cellWidth:p,cellHeight:u,renderMode:h,multiColor:A,levelColors:w,foldStrategy:M=null,paperProperties:m=null,padding:c=0,showCreases:x=!1,showPaperShape:a=!1,showFoldTargets:f=!1,showIntersections:g=!1,showGrid:b=!1,showHitCounts:R=!1,showCellOutlines:C=!1,showCreaseLines:F=!1,fontFamily:I=Ye,linesOnlyMode:D=!1,gapOverrides:Q=null}){let B=document.createElement("canvas"),l=B.getContext("2d"),H=2;B.width=o*H,B.height=s*H,l.setTransform(H,0,0,H,0,0),l.fillStyle=n,l.fillRect(0,0,o,s);let O=o/1200,_=s/1697,W=1200-c*2-145*2,L=1697-c*2-145*2,P=$n(e,p,u,W,L,Q),{cols:G,rows:T,strideX:v,strideY:nt,gridOffsetX:Dt,gridOffsetY:Nt}=P,Zt=P.cellWidth,te=P.cellHeight,we=W*O,ee=L*_,$=(c+145+Dt)*O,U=(c+145+Nt)*_,It=Zt*O,kt=te*_,Ft=v*O,Ot=nt*_,Ve=Me(e),qe=Bn(m,G,T),Je=P.actualGridWidth,Qe=P.actualGridHeight,{creases:Ee,finalShape:Ze,maxFolds:tn,firstFoldTarget:xt,lastFoldTarget:yt}=Ke(Je,Qe,t,e,Ve,M,qe),en=Ee.map(d=>({...d,p1:{x:d.p1.x*O,y:d.p1.y*_},p2:{x:d.p2.x*O,y:d.p2.y*_}})),ne=null;if(xt){let d=Math.max(0,Math.min(G-1,Math.floor(xt.x/v))),y=Math.max(0,Math.min(T-1,Math.floor(xt.y/nt)));ne=`${d},${y}`}let oe=null;if(yt){let d=Math.max(0,Math.min(G-1,Math.floor(yt.x/v))),y=Math.max(0,Math.min(T-1,Math.floor(yt.y/nt)));oe=`${d},${y}`}let{activeCreases:Gt,intersections:Mt,cellWeights:re,cellMaxGap:se}=ro(en,G,T,Ft,Ot,tn,m),dt=new Set;if(Object.keys(se).length>0){let d=Math.max(...Object.values(se));for(let[y,E]of Object.entries(se))E===d&&dt.add(y)}let nn=1+de+pe,ct=kt/nn,uo=ct>350?"large":ct>100?"medium":"small";l.font=`${ct}px ${I}`,l.textBaseline="top";let lt=[" ","\u2591","\u2592","\u2593"],vt=ct<30?2:3,q=ct*je,on=ct*de,Ce=ct*pe,Re=ct*wn,Te=ct*En,ho={" ":{width:q},"\u2591":{width:q,leftOffset:Te,bottomOverflow:Re},"\u2592":{width:q,bottomOverflow:Re},"\u2593":{width:q,bottomOverflow:Ce}},bt=Un(re),Ht=N(e+22222)(),At;Ht<.6?At=0:Ht<.8?At=1:Ht<.9?At=2:Ht<.97?At=3:At=5;let Wt=N(e+33333),wt=Wt(),J;wt<.22?J="ltr":wt<.44?J="rtl":wt<.65?J="center":wt<.8?J="alternate":wt<.9?J="diagonal":wt<.96?J="randomMid":J="checkerboard";let rn=Wt()<.5,sn=Math.floor(Wt()*G),ln=Wt()<.5,Pt=N(e+11111),ie=Pt()>=.5,an=(()=>{if(!ie)return 1;let d=Pt();return d<.2?.95:d<.4?.75:d<.6?.5:d<.8?.25:.05})(),cn=ie?Math.floor(Pt()*5):0,Et=[.95,.75,.5,.25,.05],Ie=Et.indexOf(an),Xt=Math.floor(Pt()*3)+1,fn=(d,y)=>{if(!ie)return 1;let E=Ie===-1?0:Ie;switch(cn){case 1:E=(E+Math.floor(d/2)*Xt)%Et.length;break;case 2:E=(E+Math.floor(y/2)*Xt)%Et.length;break;case 3:E=(E+(d+y)%2*Xt)%Et.length;break;case 4:E=(E+Math.floor((d+y)/2)*Xt)%Et.length;break;default:break}return Et[E]},ut=(d,y)=>A&&w?w[Math.min(d,3)]:r,Yt=N(e+22222),le=Yt()<.1,un=Math.round(2+Yt()*2)*O,hn=Math.round(1+Yt()*2)*_,dn=le?.4+Yt()*.3:0,pn=(d,y)=>{let E=N(e+22222+d*1e3+y),st=Math.floor(E()*3);return{x:st!==1?un:0,y:st!==0?hn:0}},gn=le?(()=>{let d=St(r),y;return i&&i!==r?y=St(i):y={h:(d.h+180)%360,s:Math.min(100,d.s+20),l:d.l},y.l<=d.l&&(y.l=Math.min(95,d.l+25)),Kt(y.h,y.s,y.l)})():null,Fe=(c+145)*O,ae=(c+145)*_,ce=Fe+Te,mn=ae+on,fe=Fe+we,xo=ae+ee-Ce;if(D){let d=K=>{let S=parseInt(K.slice(1,3),16),X=parseInt(K.slice(3,5),16),tt=parseInt(K.slice(5,7),16);return Cn(S,X,tt)},y=d(n),E=d(r),st=d(i),Z=Math.abs(y-E)>Math.abs(y-st)?r:i;if(Gt.length>0){l.strokeStyle=Z,l.lineWidth=2*O,l.globalAlpha=.9,l.lineCap="round";for(let K of Gt)l.beginPath(),l.moveTo($+K.p1.x,U+K.p1.y),l.lineTo($+K.p2.x,U+K.p2.y),l.stroke()}if(Mt&&Mt.length>0){l.strokeStyle=Z,l.lineWidth=1.5*O,l.globalAlpha=1;let K=4*O;for(let S of Mt)l.beginPath(),l.arc($+S.x,U+S.y,K,0,Math.PI*2),l.stroke()}l.globalAlpha=1}else if(R){let d=Math.floor(Math.min(It*.45,kt*.7));l.font=`bold ${d}px monospace`,l.textAlign="center",l.textBaseline="middle",l.fillStyle=r;for(let y=0;y<T;y++)for(let E=0;E<G;E++){let st=Math.round($+E*Ft+It/2),Z=Math.round(U+y*Ot+kt/2),K=`${E},${y}`,S=re[K]||0;S>0&&l.fillText(Math.round(S).toString(),st,Z)}l.textAlign="left",l.textBaseline="top"}else{let d=Math.max($,ce),y=Math.max(U,mn);for(let E=0;E<T;E++){let st=Math.round(y+E*Ot);if(!(st>ae+ee))for(let Z=0;Z<G;Z++){let K=Math.round(d+Z*Ft),S=`${Z},${E}`,X=re[S]||0,tt=null,z=r,k=-1,jt=!1;if(ne===S)k=X>0?Tt(X,bt):2,tt=lt[Math.min(Math.max(k,2),vt)],z=i;else if(h==="normal")if(k=Tt(X,bt),tt=lt[Math.min(k,vt)],k===0&&(tt=lt[1],jt=!0),z=ut(k,S),X>=1.5){let Ct=X-1.5,pt=30+Math.min(Ct*300,150),et=St(r);z=Kt((et.h+pt+360)%360,Math.min(100,et.s+20),Math.min(85,et.l+10))}else dt.has(S)&&X>0?z=i:oe===S&&(z=r);else if(h==="binary")X===0?(tt=lt[0],k=0,z=ut(0,S)):(k=vt,tt=lt[k],z=ut(k,S),dt.has(S)&&(z=i));else if(h==="inverted")if(k=Math.min(3-Tt(X,bt),vt),tt=lt[k],z=ut(k,S),X>=1.5){let Ct=X-1.5,pt=30+Math.min(Ct*300,150),et=St(r);z=Kt((et.h+pt+360)%360,Math.min(100,et.s+20),Math.min(85,et.l+10))}else dt.has(S)&&X>0&&(z=i);else if(h==="sparse")k=Tt(X,bt),k===1&&(tt=lt[1],z=ut(1,S),dt.has(S)&&(z=i));else if(h==="dense")if(k=Tt(X,bt),k>=2)if(tt=lt[Math.min(k,vt)],z=ut(k,S),X>=1.5){let Ct=X-1.5,pt=30+Math.min(Ct*300,150),et=St(r);z=Kt((et.h+pt+360)%360,Math.min(100,et.s+20),Math.min(85,et.l+10))}else dt.has(S)&&(z=i);else X===0&&(tt=lt[0],k=0,z=ut(0,S));if(tt){if(ne===S||oe===S)l.fillStyle=z;else{let Y=ut(Tt(X,bt),S);l.fillStyle=dt.has(S)&&X>0?i:Y}jt&&(l.globalAlpha=.1,l.fillStyle=r);let Ct=l.measureText(tt).width,pt=K+It,et=Math.min(pt,fe),_t=et-K;if(_t<q*.5)continue;let yn=fn(E,Z),Oe=q*yn,ue=Math.max(1,Math.floor((_t-q)/Oe)+1),Mn=(ue-1)*Oe+q,ft=(_t-Mn)/q>.3?ue+1:ue,gt=ft<=1?q:(_t-q)/(ft-1),Ge=At*It,ve=0;Ge>0&&(ve=Math.ceil(Ge/gt));let bn=ft+ve,at;if(J==="ltr")at="ltr";else if(J==="rtl")at="rtl";else if(J==="center")at="center";else if(J==="alternate")at=E%2===1!==rn?"rtl":"ltr";else if(J==="diagonal"){let Y=(sn+(ln?E:-E)+G*100)%G;at=Z<Y?"ltr":"rtl"}else if(J==="randomMid"){let Y=N(e+55555+E),Lt=Math.floor(Y()*G);at=Z<Lt?"ltr":"rtl"}else J==="checkerboard"?at=(E+Z)%2===0?"ltr":"rtl":at="ltr";let Bt=K+_t/2;for(let Y=0;Y<bn&&k>=0;Y++){let Lt=tt;k>=2&&Y>0&&Y%2===0&&(Lt=lt[Math.max(0,k-1)]);let ot;if(at==="center")if(Y<ft){let it=Math.floor((Y+1)/2)*gt;Y%2===0?ot=Bt+(Y===0?-q/2:it-q/2):ot=Bt-it-q/2}else{let it=Y-ft,$t=Math.floor(ft/2)*gt,Ut=Math.floor((it+1)/2)*gt;if(it%2===0){if(ot=Bt+$t+Ut,ot+q>fe)break}else if(ot=Bt-$t-Ut-q,ot<ce)break}else if(Y<ft)ot=K+Y*gt;else if(at==="rtl"){let it=Y-ft;if(ot=K-(it+1)*gt,ot<ce)break}else{let it=Y-ft;if(ot=et+it*gt,ot+q>fe)break}if(le&&!jt){let it=pn(E,Z),$t=l.globalAlpha,Ut=l.fillStyle;l.globalAlpha=dn,l.fillStyle=gn,l.fillText(Lt,ot+it.x,st+it.y),l.globalAlpha=$t,l.fillStyle=Ut}l.fillText(Lt,ot,st)}jt&&(l.globalAlpha=1)}}}}if(C){l.strokeStyle=i,l.lineWidth=.5,l.globalAlpha=1;for(let d=0;d<T;d++)for(let y=0;y<G;y++){let E=Math.round($+y*Ft),st=Math.round(U+d*Ot);l.strokeRect(E,st,It,kt)}}if(F&&Gt.length>0){let y=N(e+9292)()<.6;l.strokeStyle=y?i:r,l.lineWidth=1.5*O,l.globalAlpha=.85,l.lineCap="round";for(let E of Gt)l.beginPath(),l.moveTo($+E.p1.x,U+E.p1.y),l.lineTo($+E.p2.x,U+E.p2.y),l.stroke();l.globalAlpha=1}if(x){l.strokeStyle="#ff00ff",l.lineWidth=1,l.globalAlpha=.7;for(let d of Gt)l.beginPath(),l.moveTo($+d.p1.x,U+d.p1.y),l.lineTo($+d.p2.x,U+d.p2.y),l.stroke();l.globalAlpha=1}if(a){let d=Ze.map(y=>({x:y.x*O,y:y.y*_}));if(d.length>=3){l.strokeStyle="#00ffff",l.lineWidth=2,l.globalAlpha=.9,l.beginPath(),l.moveTo($+d[0].x,U+d[0].y);for(let y=1;y<d.length;y++)l.lineTo($+d[y].x,U+d[y].y);l.closePath(),l.stroke(),l.fillStyle="#00ffff",l.globalAlpha=.15,l.fill(),l.globalAlpha=1}}if(b){l.strokeStyle=r,l.lineWidth=1,l.globalAlpha=.3;for(let d=0;d<=G;d++){let y=$+d*Ft;l.beginPath(),l.moveTo(y,U),l.lineTo(y,U+ee),l.stroke()}for(let d=0;d<=T;d++){let y=U+d*Ot;l.beginPath(),l.moveTo($,y),l.lineTo($+we,y),l.stroke()}l.globalAlpha=1}if(f){let d=8*O;if(l.lineWidth=2,l.globalAlpha=1,xt){let y=$+xt.x*O,E=U+xt.y*_;l.strokeStyle="#00ff00",l.beginPath(),l.arc(y,E,d,0,Math.PI*2),l.stroke()}if(yt){let y=$+yt.x*O,E=U+yt.y*_;l.strokeStyle="#00ff00",l.beginPath(),l.arc(y,E,d,0,Math.PI*2),l.stroke()}}if(g&&Mt&&Mt.length>0){l.strokeStyle="#ff00ff",l.lineWidth=1.5,l.globalAlpha=.7;let d=3;for(let y of Mt)l.beginPath(),l.arc($+y.x,U+y.y,d,0,Math.PI*2),l.stroke();l.globalAlpha=1}let xn={grid:{cols:G,rows:T,colGap:P.colGap,rowGap:P.rowGap},drawDirection:J,foldStrategy:M?.type||"random",multiColor:A,showCreaseLines:F,creaseCount:Ee.length};return{dataUrl:B.toDataURL("image/png"),settings:xn}}function Ae(t,e=1200,o=1697,s=0,n=null){let r=Dn(t),i=Nn(e,o,s,t),p=kn(t),u=Me(t),h=$e(t),A=Pn(t),w=A?Wn(t,r.bg,r.text):null,M=Be(t),m=Yn(t),c=Xn(t),x=Hn(t),a=n;if(a===null){let f=N(t+9999);a=Math.floor(1+f()*500)}return{seed:t,palette:r,cells:i,renderMode:p,weightRange:u,foldStrategy:h,multiColor:A,levelColors:w,maxFolds:M,paperProperties:m,showCreaseLines:c,overlapInfo:x,folds:a}}function so(t,e,o,s=""){let n=Ae(e,1200,1697,0,o),r=Me(e),i=1200-145*2,p=1697-145*2,{creases:u}=Ke(i,p,o,e,r,n.foldStrategy,n.paperProperties),h=jn(n.paperProperties);return{name:`Fold #${t}`,description:"On-chain generative paper folding art",image:s?`${s}/${t}`:"",attributes:[{trait_type:"Fold Strategy",value:n.foldStrategy.type},{trait_type:"Render Mode",value:n.renderMode},{trait_type:"Multi-Color",value:n.multiColor?"Yes":"No"},{trait_type:"Cell Size",value:`${n.cells.cellW}x${n.cells.cellH}`},{trait_type:"Fold Count",value:o},{trait_type:"Max Folds",value:n.maxFolds},{trait_type:"Crease Count",value:u.length},{trait_type:"Palette Strategy",value:n.palette.strategy},{trait_type:"Paper Type",value:h},{trait_type:"Paper Grain",value:n.paperProperties.angleAffinity!==null?"Grain":"Uniform"},...n.showCreaseLines?[{trait_type:"Crease Lines",value:"Visible"}]:[]]}}async function io(t){if(!t)return!1;let e=document.createElement("style");e.textContent=`
    @font-face {
      font-family: '${Jt}';
      src: url('${t}');
    }
  `,document.head.appendChild(e);try{return await document.fonts.load(`12px ${Jt}`),!0}catch(o){return console.warn("Failed to load on-chain font:",o),!1}}function lo(t){if(typeof t=="number")return t;if(typeof t!="string")return 0;let e=t.replace(/^0x/,"").slice(0,16),o=BigInt("0x"+e);return Number(o%BigInt(2147483647))}function ao(){let t=window.devicePixelRatio||1,e=window.innerWidth,o=window.innerHeight,s=1/Math.sqrt(2),n,r;e/o>s?(r=o,n=Math.floor(r*s)):(n=e,r=Math.floor(n/s));let i=Math.floor(n*t),p=Math.floor(r*t);return{width:n,height:r,renderWidth:i,renderHeight:p,dpr:t}}var mt=null;function Pe(t,e){if(t===0)return"none";let o=t/e;return o<0?`${Math.round(o*100)}% overlap`:`${Math.round(o*100)}% gap`}var xe=!1,ht=!1,zt=0,he=null,Vt=null;function co(t,e,o={}){let{foldOverride:s,linesOnly:n=!1,isAnimating:r=!1,width:i,height:p,showOverlays:u,gapOverrides:h=null}=o,A=i&&p?{renderWidth:i,renderHeight:p,width:i,height:p}:ao(),w=s!==void 0?s:e.foldCount,M=u!==void 0?u:r?n:n||xe,{dataUrl:m,settings:c}=ze({folds:w,seed:e.seed,outputWidth:A.renderWidth,outputHeight:A.renderHeight,bgColor:e.params.palette.bg,textColor:e.params.palette.text,accentColor:e.params.palette.accent,cellWidth:e.params.cells.cellW,cellHeight:e.params.cells.cellH,renderMode:e.params.renderMode,multiColor:e.params.multiColor,levelColors:e.params.levelColors,foldStrategy:e.params.foldStrategy,paperProperties:e.params.paperProperties,showCreaseLines:e.params.showCreaseLines,showCreases:M,showIntersections:M,linesOnlyMode:n,gapOverrides:h}),x=document.getElementById("info");if(x){let f=Pe(c.grid.colGap,e.params.cells.cellW),g=Pe(c.grid.rowGap,e.params.cells.cellH),b=[`${c.grid.cols}\xD7${c.grid.rows}`,`dir:${c.drawDirection}`,`strategy:${c.foldStrategy}`];f!=="none"&&b.push(`col:${f}`),g!=="none"&&b.push(`row:${g}`),c.multiColor&&b.push("multiColor"),c.showCreaseLines&&b.push("creaseLines"),x.textContent=b.join(" | ")}let a=new Image;return a.onload=()=>{let f=t.getContext("2d");t.width=A.renderWidth*2,t.height=A.renderHeight*2,t.style.width=A.width+"px",t.style.height=A.height+"px",f.drawImage(a,0,0,t.width,t.height),typeof window<"u"&&typeof window.scaleCanvas=="function"&&window.scaleCanvas()},a.src=m,{dataUrl:m,settings:c}}function qt(t,e,o,s,n){return co(t,e,{foldOverride:o,linesOnly:s,isAnimating:n})}function fo(t,e){let o;return function(...s){clearTimeout(o),o=setTimeout(()=>t.apply(this,s),e)}}async function ye(){let t=typeof window<"u"&&window.SEED,e=typeof window<"u"&&window.FOLD_COUNT,o=typeof window<"u"&&window.LESS_SEED;if(o&&!t&&(t=lo(o)),t&&e===void 0){let n=N(t+9999);e=Math.floor(1+n()*500)}let s=typeof window<"u"&&window.FONT_DATA_URI||Xe;if(t&&e!==void 0){let i=function(){if(!ht||zt>e){u();return}qt(n,mt,zt,he==="lines-only",!0),zt++,Vt=setTimeout(i,50)},p=function(h){ht=!0,zt=0,he=h,i()},u=function(){ht=!1,he=null,Vt&&(clearTimeout(Vt),Vt=null)},n=document.getElementById("c")||document.querySelector("canvas");n||(n=document.createElement("canvas"),n.id="c",document.body.appendChild(n),document.body.style.cssText="margin:0;padding:0;background:#000;display:flex;align-items:center;justify-content:center;min-height:100vh;overflow:hidden;"),await io(s);let r=Ae(t,1200,1697,0,e);mt={seed:t,foldCount:e,params:r},qt(n,mt),window.addEventListener("resize",fo(()=>{mt&&!ht&&qt(n,mt)},150)),document.addEventListener("keydown",h=>{mt&&(h.shiftKey&&h.key==="F"&&(h.preventDefault(),xe=!xe,ht||qt(n,mt)),h.shiftKey&&h.key==="A"&&(h.preventDefault(),ht&&u(),p("full")),h.shiftKey&&h.key==="L"&&(h.preventDefault(),ht&&u(),p("lines-only")),h.key==="Escape"&&ht&&(h.preventDefault(),u()))})}}typeof window<"u"&&(window.SEED||window.FOLD_COUNT!==void 0||window.LESS_SEED)&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>ye()):ye());})();
